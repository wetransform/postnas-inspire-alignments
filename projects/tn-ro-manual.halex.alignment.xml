<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<alignment xmlns="http://www.esdi-humboldt.eu/hale/alignment">
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.geometry.simplefeature" name="Simple Feature Geometrie" type="groovy">
            <cf:input eager="true" maxOccurs="1" minOccurs="1" name="geometrie"/>
            <cf:output eager="false" maxOccurs="1" minOccurs="1"/>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def geoms = _.geom.toSimpleGeometries(geometries: _.geom.aggregate(geometrie), collections: false)
if (geoms) {
	if (geoms.size() &gt; 1) {
		_log.error("Mehrere Geometrien gefunden - Aufteilung nötig")
	}
	_target(geoms[0])
}
else {
	_log.error("Keine Geometrie gefunden")
}
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Überführt die Quell-Geometrien als eine zusammengefasste Simple Feature Geometrie (ohne Multi-Geometrien).

Nur erfolgreich falls genau eine Simple Feature Geometrie gebildet werden kann. Andernfalls wird ein entsprechender Fehler in die Transformations-Logs eingetragen.
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.geometry.simplefeature.multi" name="Simple Feature Geometrie (Multi)" type="groovy">
            <cf:input eager="true" maxOccurs="1" minOccurs="1" name="geometrie"/>
            <cf:output eager="false" maxOccurs="1" minOccurs="1"/>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def geoms = _.geom.toSimpleGeometries(geometries: _.geom.aggregate(geometrie), collections: true)
if (geoms) {
	if (geoms.size() &gt; 1) {
		_log.error("Mehrere Geometrien gefunden - Aufteilung nötig")
	}
	_target(geoms[0])
}
else {
	_log.error("Keine Geometrie gefunden")
}
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Überführt die Quell-Geometrien als eine zusammengefasste Simple Feature Geometrie (ggf. als Multi-Geometrie).

Nur erfolgreich falls genau eine Simple Feature Geometrie gebildet werden kann. Andernfalls wird ein entsprechender Fehler in die Transformations-Logs eingetragen.
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.AX_Lagebezeichnung.GeographicalName" name="AX_Lagebezeichnung zu GeographicalName" type="groovy">
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_unverschluesselt">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_land">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_regierungsbezirk">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_kreis">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_gemeinde">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="lage_lage">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:type name="GeographicalNameType" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </cf:output>
            <cf:param maxOccurs="1" minOccurs="0" name="source">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Quelle des Namens. Falls nicht angegeben wird sie aus einer Projekt-Variable bestimmt.</core:text>
                </cf:description>
                <cf:display value="Source of name"/>
                <cf:binding>java.lang.String</cf:binding>
            </cf:param>
            <cf:param maxOccurs="1" minOccurs="0" name="nameStatus">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Status des Namens. Falls nicht angegeben wird als Standardwert official angenommen.</core:text>
                </cf:description>
                <cf:display value="nameStatus"/>
                <cf:value>standardised</cf:value>
                <cf:value>other</cf:value>
                <cf:value>official</cf:value>
                <cf:value>historical</cf:value>
                <cf:value>unpopulated</cf:value>
                <cf:value>unknown</cf:value>
            </cf:param>
            <cf:param maxOccurs="1" minOccurs="0" name="nativeness">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Ortsüblichkeit des Namens. Falls nicht angegeben wird als Standardwert endonym angenommen.</core:text>
                </cf:description>
                <cf:display value="nativeness"/>
                <cf:value>endonym</cf:value>
                <cf:value>unpopulated</cf:value>
                <cf:value>exonym</cf:value>
                <cf:value>unknown</cf:value>
            </cf:param>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def name = lage_unverschluesselt

if (!name) {
	// Namen auch aus verschlüsselter Lagebezeichnung ableiten
	
	def gemeinde = lage_gemeinde
	def kreis = lage_kreis
	def lage = lage_lage
	def land = lage_land
	def reg = lage_regierungsbezirk

	if (land &amp;&amp; gemeinde &amp;&amp; kreis &amp;&amp; lage) {
		if (!reg) reg = '0'
		def schluesselGesamt = "$land$reg$kreis$gemeinde$lage"
		
		withTransformationContext {
			def collect = _.context.collector(it)
	  
			// Name zu Schlüssel der Lagebezeichnung aus Index holen
			if (collect.lagebezeichnung[schluesselGesamt].value()){
				name = collect.lagebezeichnung[schluesselGesamt].value()
			}
			else _log.error("Für einen Namen aus einer verschlüsselten Lagebezeichnung mit Schlüssel ${schluesselGesamt} liegt kein Katalogeintrag vor.")
		}
	}
}

if (name) {
	def sourceName_var = _project.vars.get('ADV_MODELLART', null)

	_target {
		// source

		// Priorität 1 - feste Quelle
		if (_params.source) {
			sourceOfName( _params.source )
		}
		// Priorität 2 - aus Projektvariable
		else if (sourceName_var) {
			sourceOfName( sourceName_var )
		}
		else {
			sourceOfName {
				nilReason( 'unknown' )
			}
		}

		// nativeness
		def nn = _params.nativeness
		if (nn) {
			if (nn == 'unpopulated') {
				nativeness {
					nilReason( 'other:unpopulated' )
				}
			}
			else if (nn == 'unknown') {
				nativeness {
					nilReason( 'unknown' )
				}
			}
			else {
				nativeness {
					href( 'http://inspire.ec.europa.eu/codelist/NativenessValue/' + nn )
				}
			}
		}
		else {
			// default for nativeness if not specified is endonym
			nativeness {
				href( 'http://inspire.ec.europa.eu/codelist/NativenessValue/endonym' )
			}
		}

		// nameStatus
		def ns = _params.nameStatus
		if (ns) {
			if (ns == 'unpopulated') {
				nameStatus {
					nilReason( 'other:unpopulated' )
				}
			}
			else if (ns == 'unknown') {
				nameStatus {
					nilReason( 'unknown' )
				}
			}
			else {
				nameStatus {
					href( 'http://inspire.ec.europa.eu/codelist/NameStatusValue/' + ns )
				}
			}
		}
		else {
			// default for nameStatus if not specified is official
			nameStatus {
				href( 'http://inspire.ec.europa.eu/codelist/NameStatusValue/official' )
			}
		}

		// spelling
		spelling {
			SpellingOfName {
				text( name )
				script( 'Latn' )
			}
		}
		// language
		language( 'deu' )
	}
}
else {
	throw new NoResultException()
}
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Erstellt ein GeographicalName-Objekt aus einer Lagebezeichnung.&#13;
Eine unverschlüsselte Lagebezeichnung wird direkt als Name übernommen.&#13;
Falls stattdessen eine verschlüsselte Lagebezeichnung vorliegt (nur in ALKIS/DLKM möglich), wird versucht den Namen über den Schlüssel in einem Index nachzuschlagen.&#13;
Trifft keiner der beiden Fälle zu, oder kann der Name nicht nachgeschlagen werden, wird kein GeographicalName erzeugt.&#13;
&#13;
Die Sprache des Namens wird als Deutsch angenommen.&#13;
&#13;
&lt;% if (_params.nameStatus) {&#13;
  if (_params.nameStatus == 'unpopulated') {&#13;
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird nicht angegeben, als *nilReason* wird `other:unpopulated` angegeben."&#13;
  }&#13;
  else if (_params.nameStatus == 'unknown') {&#13;
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird nicht angegeben, als *nilReason* wird `unknown` angegeben."&#13;
  }&#13;
  else {&#13;
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird als ${_params.nameStatus} angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NameStatusValue&gt;)."&#13;
  }&#13;
}&#13;
else {&#13;
  out &lt;&lt; "Der Status des Namens (`nameStatus`) wird als *official* angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NameStatusValue&gt;)."&#13;
}&#13;
out &lt;&lt; "\n\n"&#13;
if (_params.nativeness) {&#13;
  if (_params.nativeness == 'unpopulated') {&#13;
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird nicht angegeben, als *nilReason* wird `other:unpopulated` angegeben."&#13;
  }&#13;
  else if (_params.nativeness == 'unknown') {&#13;
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird nicht angegeben, als *nilReason* wird `unknown` angegeben."&#13;
  }&#13;
  else {&#13;
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird als ${_params.nativeness} angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NativenessValue&gt;)."&#13;
  }&#13;
}&#13;
else {&#13;
  out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird als *endonym* angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NativenessValue&gt;)."&#13;
}&#13;
out &lt;&lt; "\n\n"&#13;
if (_params.source) {&#13;&#13;
  out &lt;&lt; "Die Quelle des Namens (`sourceOfName`) wird als ${_params.source} angegeben."&#13;&#13;
} else {&#13;&#13;
  out &lt;&lt; "Die Quelle des Namens (`sourceOfName`) wird aus einer Projekt-Variable (`ADV_MODELLART`) bestimmt, falls vorhanden."&#13;&#13;
} %&gt;
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.GeographicalName.simple" name="Einfacher GeographicalName (Deutsch)" type="groovy">
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="spelling">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:input eager="true" maxOccurs="1" minOccurs="0" name="source">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:type name="GeographicalNameType" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </cf:output>
            <cf:param maxOccurs="1" minOccurs="0" name="source">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Quelle des Namens. Falls nicht angegeben wird sie aus einer Projekt-Variable oder, falls konfiguriert, aus dem Quell-Objekt bestimmt.</core:text>
                </cf:description>
                <cf:display value="Source of name"/>
                <cf:binding>java.lang.String</cf:binding>
            </cf:param>
            <cf:param maxOccurs="1" minOccurs="0" name="nameStatus">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Status des Namens. Falls nicht angegeben wird als Standardwert official angenommen.</core:text>
                </cf:description>
                <cf:display value="nameStatus"/>
                <cf:value>standardised</cf:value>
                <cf:value>other</cf:value>
                <cf:value>official</cf:value>
                <cf:value>historical</cf:value>
                <cf:value>unpopulated</cf:value>
                <cf:value>unknown</cf:value>
            </cf:param>
            <cf:param maxOccurs="1" minOccurs="0" name="nativeness">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Ortsüblichkeit des Namens. Falls nicht angegeben wird als Standardwert endonym angenommen.</core:text>
                </cf:description>
                <cf:display value="nativeness"/>
                <cf:value>endonym</cf:value>
                <cf:value>unpopulated</cf:value>
                <cf:value>exonym</cf:value>
                <cf:value>unknown</cf:value>
            </cf:param>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def sourceNameFromModellart() {
	if (source) {
		def modelle = source.p.AA_Modellart.advStandardModell.values()
		if (modelle) {
			//TODO Logik um korrektes anzugebendes Modell zu bestimmen?
			//XXX Vorerst wird erstes Modell zurückgegeben
			return modelle[0]
		}
	}
	
	null
}

def sourceName_input = sourceNameFromModellart()
def sourceName_var = _project.vars.get('ADV_MODELLART', null)

if (spelling) {
	_target {
		
		// Priorität 1 - feste Quelle
		if (_params.source) {
			sourceOfName( _params.source )
		}
		// Priorität 2 - aus Projektvariable
		else if (sourceName_var) {
			sourceOfName( sourceName_var )
		}
		// Priorität 3 - aus Quell-Objekt
		else if (sourceName_input) {
			sourceOfName( sourceName_input )
		}
		else {
			sourceOfName {
				nilReason( 'unknown' )
			}
		}
		pronunciation {
			nilReason( 'other:unpopulated' )
		}
		// nameStatus
		def ns = _params.nameStatus
		if (ns) {
			if (ns == 'unpopulated') {
				nameStatus {
					nilReason( 'other:unpopulated' )
				}
			}
			else if (ns == 'unknown') {
				nameStatus {
					nilReason( 'unknown' )
				}
			}
			else {
				nameStatus {
					href( 'http://inspire.ec.europa.eu/codelist/NameStatusValue/' + ns )
				}
			}
		}
		else {
			// default for nameStatus if not specified is official
			nameStatus {
				href( 'http://inspire.ec.europa.eu/codelist/NameStatusValue/official' )
			}
		}
		// nativeness
		def nn = _params.nativeness
		if (nn) {
			if (nn == 'unpopulated') {
				nativeness {
					nilReason( 'other:unpopulated' )
				}
			}
			else if (nn == 'unknown') {
				nativeness {
					nilReason( 'unknown' )
				}
			}
			else {
				nativeness {
					href( 'http://inspire.ec.europa.eu/codelist/NativenessValue/' + nn )
				}
			}
		}
		else {
			// default for nativeness if not specified is endonym
			nativeness {
				href( 'http://inspire.ec.europa.eu/codelist/NativenessValue/endonym' )
			}
		}
		spelling {
			SpellingOfName {
				text( spelling )
				script ( 'Latn' )
			}
		}
		language( 'deu' )
	}
}
else {
	throw new NoResultException()
}
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Bildet ein GeographicalName-Objekt zu einem einfachen Namen. Der Wert des Quell-Attributs $spelling wird als Schreibweise des Namens übernommen (`SpellingOfName`).&#13;
&#13;
Die Sprache wird als Deutsch angenommen.&#13;

&lt;% if (_params.nameStatus) {
  if (_params.nameStatus == 'unpopulated') {
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird nicht angegeben, als *nilReason* wird `other:unpopulated` angegeben."
  }
  else if (_params.nameStatus == 'unknown') {
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird nicht angegeben, als *nilReason* wird `unknown` angegeben."
  }
  else {
    out &lt;&lt; "Der Status des Namens (`nameStatus`) wird als ${_params.nameStatus} angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NameStatusValue&gt;)."
  }
}
else {
  out &lt;&lt; "Der Status des Namens (`nameStatus`) wird als *official* angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NameStatusValue&gt;)."
}
out &lt;&lt; "\n\n"
if (_params.nativeness) {
  if (_params.nativeness == 'unpopulated') {
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird nicht angegeben, als *nilReason* wird `other:unpopulated` angegeben."
  }
  else if (_params.nativeness == 'unknown') {
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird nicht angegeben, als *nilReason* wird `unknown` angegeben."
  }
  else {
    out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird als ${_params.nativeness} angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NativenessValue&gt;)."
  }
}
else {
  out &lt;&lt; "Die Ortsüblichkeit (`nativeness`) wird als *endonym* angegeben (siehe &lt;http://inspire.ec.europa.eu/codelist/NativenessValue&gt;)."
}
out &lt;&lt; "\n\n"
if (_params.source) {&#13;
  out &lt;&lt; "Die Quelle des Namens (`sourceOfName`) wird als ${_params.source} angegeben."&#13;
} else if (source) {&#13;
  out &lt;&lt; "Die Quelle des Namens (`sourceOfName`) wird aus einer Projekt-Variable (`ADV_MODELLART`) bestimmt, falls vorhanden, andernfalls wird das Quell-Attribut $source dafür herangezogen. "&#13;
  out &lt;&lt; "In letzterem Fall kann nur eine von potentiell mehreren im Quellobjekt angegebenen Modellarten übernommen werden."&#13;
} else {&#13;
  out &lt;&lt; "Die Quelle des Namens (`sourceOfName`) wird aus einer Projekt-Variable (`ADV_MODELLART`) bestimmt, falls vorhanden."&#13;
} %&gt;
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.date.earliest" name="Jüngstes Datum" type="groovy">
            <cf:input eager="true" maxOccurs="-1" minOccurs="1" name="dates">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:binding>java.lang.String</cf:binding>
            </cf:output>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
//import java.text.SimpleDateFormat
//def formatter = new SimpleDateFormat('yyyy-MM-dd')

// all source dates as list
def values = dates.p.values()

if (!values) {
	// no result
	return null
}

// try to convert to date
values = values.collect { value -&gt;
	def result
	//XXX skip instanceof check - instanceof is not supported by Groovy Sandbox
	// and Class.isInstance requires the Groovy restriction to be lifted
	//if (Date.isInstance(value)) {
	//	result = value
	//}
	//TODO also support parsing based on provided pattern?
	if (result == null) {
		// try hale conversion
		result = _.convert(value: value, to: Date)
	}
	if (result == null) {
		result = value as Date
	}
	result
}

// sort dates
values.sort()

// yield last date
values[-1]
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Liefert das jüngste Datum/Zeit aller Eingabedaten.</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.id.default" name="AdV INSPIRE localId" type="groovy">
            <cf:input eager="true" maxOccurs="-1" minOccurs="1" name="id">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:binding>java.lang.String</cf:binding>
            </cf:output>
            <cf:param maxOccurs="1" minOccurs="0" name="collectorName">
                <cf:description>
                    <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">Name eines Kollektors, der verwendet werden soll, um die erzeugten IDs zu sammeln.</core:text>
                </cf:description>
                <cf:display value="Collector name"/>
                <cf:binding>java.lang.String</cf:binding>
            </cf:param>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// alle Quell-IDs als Liste
def identifiers = id.p.values()

def id

if (identifiers.size() == 1) {
  // verwende Original-ID falls nur eine Quelle
  id = identifiers[0]
}
else {
  // sortieren (TODO spezielle Ordnung benötigt?)
  identifiers = identifiers.sort()

  def identString = identifiers.join()

  id = '_' + _.crypto.sha256(identString)
}

// Ziel-Typ als Präfix
if (true /*_params.useTargetTypePrefix*/) {
  def targetType = _targetType.definition.name.localPart
  if (targetType) {
    if (targetType.endsWith('Type')) {
      targetType = targetType[0..-5]
    }
  
    if (!id.startsWith('_')) {
      id = '_' + id
    }
    id = targetType + id
  }
}

// Falls ein Collector-Name angegeben wurde, IDs in diesem einspeisen

if (_params.collectorName) {
  withTransformationContext {
    def c = _.context.collector(it)
    c[_params.collectorName] &lt;&lt; id
  }
}

id
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Bestimmung einer INSPIRE localId oder GML id aus Fachkennzeichen oder AAA-ObjektIDs.

Für eine einzige Quell-ID wird diese direkt herangezogen.

Andernfalls wird unter Verwendung des SHA256-Algorithmus ein Hash-Wert aus den sortierten und dann konkatenierten Quell-IDs gebildet und hexadezimal kodiert.

Außerdem wird der Name des Feature-Typs des Ziel-Modells als Präfix vorangestellt. Dabei wird sichergestellt dass der Typ-Name von den weiteren Teilen der ID durch einen Unterstrich getrennt ist.
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.identifier" name="AdV INSPIRE identifier (URI)" type="groovy">
            <cf:input eager="true" maxOccurs="-1" minOccurs="1" name="id">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:type name="CodeWithAuthorityType" ns="http://www.opengis.net/gml/3.2"/>
            </cf:output>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// alle Quell-IDs als Liste
def identifiers = id.p.values()

def id

if (identifiers.size() == 1) {
  // verwende Original-ID falls nur eine Quelle
  id = identifiers[0]
}
else {
  // sortieren (TODO spezielle Ordnung benötigt?)
  identifiers = identifiers.sort()

  def identString = identifiers.join()

  id = '_' + _.crypto.sha256(identString)
}

// Ziel-Typ als Präfix
if (true /*_params.useTargetTypePrefix*/) {
  def targetType = _targetType.definition.name.localPart
  if (targetType) {
    if (targetType.endsWith('Type')) {
      targetType = targetType[0..-5]
    }
  
    if (!id.startsWith('_')) {
      id = '_' + id
    }
    id = targetType + id
  }
}

// Verknüpfung mit namespace
def namespace = _project.vars.INSPIRE_NAMESPACE
if (namespace) {
  if (!namespace.endsWith('/')) {
    namespace = namespace + '/'
  }
  
  // namespace und id als Ergebnis
  _target(namespace + id) {
	codeSpace( 'http://inspire.ec.europa.eu/ids' )
  }
}
else {
  // nur id als Ergebnis
  _target(id) {
	codeSpace( 'http://inspire.ec.europa.eu/ids' )
  }
}
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Bestimmung eines GML identifiers URI bestehend INSPIRE namespace und localId aus Fachkennzeichen oder AAA-ObjektIDs.

Für eine einzige Quell-ID wird diese direkt für die localId herangezogen. Andernfalls wird unter Verwendung des SHA256-Algorithmus ein Hash-Wert aus den sortierten und dann konkatenierten Quell-IDs gebildet und hexadezimal kodiert.
Als Präfix wird der localId der Name des Feature-Typs des Ziel-Modells vorangestellt. Dabei wird sichergestellt dass der Typ-Name von den weiteren Teilen der ID durch einen Unterstrich getrennt ist.

Der für Datenanbieter und Datensatz spezifische Namespace muss als Vorgabe (Projekt-Variable) konfiguriert werden.

Der `codeSpace` für den GML identifier wird als `http://inspire.ec.europa.eu/ids` gesetzt.
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.inspire.namespace" name="AdV INSPIRE ID namespace" type="groovy">
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:binding>java.lang.String</cf:binding>
            </cf:output>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// verwende Wert aus Projekt-Variable "INSPIRE_NAMESPACE"
_project.vars.INSPIRE_NAMESPACE
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Setzt $_target auf den für den Datensatz vorgegebenen festen INSPIRE Namespace.

Der für Datenanbieter und Datensatz spezifische Namespace muss dafür als Vorgabe (Projekt-Variable) konfiguriert werden.
</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <customFunction>
        <cf:custom-property-function xmlns:cf="http://www.esdi-humboldt.eu/hale/custom-function" identifier="adv.uom.toucum" name="AdV Maßeinheit zu UCUM" type="groovy">
            <cf:input eager="false" maxOccurs="1" minOccurs="1" name="uom">
                <cf:binding>java.lang.String</cf:binding>
            </cf:input>
            <cf:output eager="false" maxOccurs="1" minOccurs="1">
                <cf:binding>java.lang.String</cf:binding>
            </cf:output>
            <cf:definition>
                <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
if (!uom) {
	throw new NoResultException()
}

def result

// Mapping auf UCUM
switch(uom) {
case 'urn:adv:uom:m2':
	result = 'm2'
	break
case 'urn:adv:uom:m':
	result = 'm'
	break
case 'urn:adv:uom:km':
	result = 'km'
	break
}

if (!result) {
	// Transformations-Warnung falls kein Mapping auf UCUM vorhanden
	_log.warn("Unknown UCUM representation for unit of measurment $uom, using code as-is")
	result = uom
}

result
</core:text>
            </cf:definition>
            <cf:explanation>
                <cf:locale country="" language="" variant="">
                    <cf:template>
                        <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
Abbildung von Maßeinheiten aus AdV URNs nach UCUM

*Keine vollständige Abbildung, muss ggf. ergänzt werden.*

Aktuell ist folgende Abbildung umgesetzt:

- `urn:adv:uom:m2` zu `m2`
- `urn:adv:uom:m`zu `m`

</core:text>
                    </cf:template>
                </cf:locale>
            </cf:explanation>
        </cf:custom-property-function>
    </customFunction>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C33b5349d-fb85-4c7d-8519-ac27e4c49867" priority="highest">
        <source>
            <class>
                <type name="ax_bauwerkimgewaesserbereich" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="AbstractFeatureType" ns="http://www.opengis.net/gml/3.2"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def bwf = _source.p.bauwerksfunktion.value()
def identifier = _source.p.gml_id.value()

withTransformationContext {
  def collect = _.context.collector(it)
  
  // Bauwerksfunktion zu Identifier des Objekts im Index ablegen
  collect.bauwerksfunktion[identifier] = bwf
}
</core:text>
        </complexParameter>
        <documentation>Dies ist eine Dummy-Transformationsdefinition die keine Objekte erzeugt sondern zum Aufbauen eines Index für die Bauwerksfunktion von `AX_BauwerkImGewaesserbereich` dient.
Diese Information wird herangezogen um entsprechend für REO-Objekte über die Beziehung `hatDirektUnten` den entsprechenden Wert für die *TransportProperty* `VerticalPosition` zu bestimmen.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C43232927-f863-47e3-b297-dd8902f4bbc7" priority="highest">
        <source>
            <class>
                <type name="ax_bauwerkimverkehrsbereich" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="AbstractFeatureType" ns="http://www.opengis.net/gml/3.2"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def bwf = _source.p.bauwerksfunktion.value()
def identifier = _source.p.gml_id.value()

withTransformationContext {
  def collect = _.context.collector(it)
  
  // Bauwerksfunktion zu Identifier des Objekts im Index ablegen
  collect.bauwerksfunktion[identifier] = bwf
}
</core:text>
        </complexParameter>
        <documentation>Dies ist eine Dummy-Transformationsdefinition die keine Objekte erzeugt sondern zum Aufbauen eines Index für die Bauwerksfunktion von `AX_BauwerkImVerkehrsbereich` dient.
Diese Information wird herangezogen um entsprechend für REO-Objekte über die Beziehung `hatDirektUnten` den entsprechenden Wert für die *TransportProperty* `VerticalPosition` zu bestimmen.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C44422922-aa67-4d00-bc52-a77a4ed816b8" priority="highest">
        <source>
            <class>
                <type name="ax_lagebezeichnungkatalogeintrag" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="AbstractFeatureType" ns="http://www.opengis.net/gml/3.2"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def name = _source.p.bezeichnung.value()
def schluessel = _source.p.schluesselgesamt.value()

withTransformationContext {
  def collect = _.context.collector(it)
  
  // Name zu Schlüssel der Lagebezeichnung im Index ablegen
  collect.lagebezeichnung[schluessel] = name
}
</core:text>
        </complexParameter>
        <documentation>Dies ist eine Dummy-Transformationsdefinition die keine Objekte erzeugt sondern zum Aufbauen eines Index für `AX_LagebezeichnungKatalogeintrag` dient.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Ce6d4faab-cbaa-40c4-a1bf-76463a654af1" priority="low">
        <target>
            <class>
                <type name="AccessRestrictionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
// Erstelle ein AccessRestriction-Objekt für jeden vorkommenden Wert&#13;
collect.accessRestriction.consume { key, values -&gt;&#13;
	def _id = 'AccessRestriction_' + key&#13;
	def _ns = _project.vars.INSPIRE_NAMESPACE&#13;
	&#13;
	_target {&#13;
		restriction {&#13;
			href( 'http://inspire.ec.europa.eu/codelist/AccessRestrictionValue/' + key)&#13;
		}&#13;
		id( _id )&#13;
		inspireId {&#13;
			Identifier {&#13;
				namespace( _ns )&#13;
				localId( _id )&#13;
			}&#13;
		}&#13;
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {&#13;
			codeSpace( 'http://inspire.ec.europa.eu/ids' )&#13;
		}&#13;
		&#13;
		// Referenz zu gesammelten RoadLinks/RoadAreas mit dieser Eigenschaft&#13;
		values.each { linkId -&gt;&#13;
			networkRef {&#13;
				NetworkReference {&#13;
					element {&#13;
						href( "#$linkId" )&#13;
					}&#13;
				}&#13;
			}&#13;
		}&#13;
	}&#13;
}
</core:text>
        </complexParameter>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_Ce6d4faab-cbaa-40c4-a1bf-76463a654af1" priority="normal">
        <target>
            <property>
                <type name="AccessRestrictionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_Ce6d4faab-cbaa-40c4-a1bf-76463a654af1" priority="normal">
        <target>
            <property>
                <type name="AccessRestrictionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C1eb2d011-34d1-4077-8388-f7fbdb1659b9" priority="low">
        <target>
            <class>
                <type name="ConditionOfFacilityType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Die Code-Liste für ConditionOfFacility
def codeList = 'http://inspire.ec.europa.eu/codelist/ConditionOfFacilityValue'

def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

// Erstelle ein ConditionOfFacility-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.conditionOfFacility.consume { key, values -&gt;
	def _id = 'ConditionOfFacility_' + _project.vars.THEME_DISTINGUISHER + '_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	def valueGroups = _refLimit ? values.collate(_refLimit as int) : [values]
	def i = 1		
	valueGroups.each { valueGroup -&gt;
		def _id2 = _id 
		if (valueGroups.size &gt; 1) {
			// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
			_id2 += '_' + i++
		}
		_target {
			currentStatus {
				href( "$codeList/$key" )
			}
			id( _id2 )
			inspireId {
				Identifier {
					namespace( _ns )
					localId( _id2 )
				}
			}
			identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
				codeSpace( 'http://inspire.ec.europa.eu/ids' )
			}
			
			valueGroup.each { linkId -&gt;
				networkRef {
					NetworkReference {
						element {
							href( "#$linkId" )
						}
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `ConditionOfFacility`-Objekt für jeden in den Daten vorkommenden Wert der [ConditionOfFacilityValue Code-Liste](http://inspire.ec.europa.eu/codelist/ConditionOfFacilityValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Code-Listen Wert gebildet, z.B. `ConditionOfFacility_functional`.

Es werden Referenzen (`NetworkReference`) zu allen Netzwerk-Elementen (z.B. *TransportLinks* und *TransportAreas*) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C1eb2d011-34d1-4077-8388-f7fbdb1659b9" priority="normal">
        <target>
            <property>
                <type name="ConditionOfFacilityType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C1eb2d011-34d1-4077-8388-f7fbdb1659b9" priority="normal">
        <target>
            <property>
                <type name="ConditionOfFacilityType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.join" id="Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source name="types">
            <class>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="join">
            <jp:join-parameter xmlns:jp="http://www.esdi-humboldt.eu/hale/join">
                <class>
                    <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                        <condition lang="CQL">internationalebedeutung = '2001'</condition>
                    </type>
                </class>
                <class>
                    <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <class>
                    <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                            <condition lang="CQL">internationalebedeutung = '2001'</condition>
                        </type>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                            <condition lang="CQL">internationalebedeutung = '2001'</condition>
                        </type>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
            </jp:join-parameter>
        </complexParameter>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Strasse nach ERoad -&gt; stelle Verknpüfung zu RoadLinks her

// Fahrbahnachsen werden präferiert als RoadLink für
// Strassen verwendet, alternativ verwende Strassenachsen

boolean hatFahrbahnachse = !!_source.links.ax_fahrbahnachse.first()
boolean hatStrassenachse = !!_source.links.ax_strassenachse.first()

def strasseId = _source.p.gml_id.value()
if (!hatFahrbahnachse &amp;&amp; !hatStrassenachse) {
	_log.warn("ERoad: Strasse $strasseId hat weder Fahrbahnachsen noch Strassenachsen")
	throw new NoResultException('Kann kein ERoad-Objekt ohne RoadLinks erstellen')
}

// erstelle ERoad

_target {
	if (hatFahrbahnachse) {
		_source.links.ax_fahrbahnachse.each { achse -&gt;
			link {
				href( '#RoadLink_' + achse.p.gml_id.value() )
			}
		}
	}
	else if (hatStrassenachse) {
		_source.links.ax_strassenachse.each { achse -&gt;
			link {
				href( '#RoadLink_' + achse.p.gml_id.value() )
			}
		}
	}
}

// Sammle ID für Netzwerk
withTransformationContext {
	_.context.collector(it).network &lt;&lt; "ERoad_$strasseId"
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `ERoad`s zu `AX_Strasse`.

Die zugehörigen `AX_Fahrbahnachse`n (nur Basis-DLM) und `AX_Strassenachse`n werden bestimmt um die Verknüpfung zu den entsprechend zu erstellenden `RoadLink`-Objekten herstellen zu können (in der Eigenschaft `link`).
Falls Fahrbahnachsen zu der Straße verfügbar sind werden diese zur Repräsentation der `RoadLink`s verwendet, andernfalls die Straßenachsen.

Die erstellte `ERoad` wird dem Index von Netzwerk-Elementen hinzugefügt.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cf04bf7cb-0c75-4a85-a346-ff2791070e27_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ca5cd019b-6e90-4f57-b478-94908d192233_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cca1117da-b1b7-438c-a90d-89e71b6e0c72" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="bezeichnung">
                    <condition lang="CQL">value LIKE 'E%'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="europeanRouteNumber" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C006ef0a4-6836-420e-bd48-757ca82e3668" priority="normal">
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="europeanRouteNumber" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="unknown" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C055eee92-8f70-4d3b-9771-2b7346cd7f6f_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C5855cff4-b320-4f0c-bd53-c8d282791687_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C683c368a-e836-4ee4-9c47-abce43294ae6_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <target name="result">
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C8a40758b-371a-4883-9294-1adafd5bc376_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung = '2001'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="Cc2269463-2fe0-460d-883d-6da676dbb1bc_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6da68b64-b734-429c-acd4-bd1fd5b68db1_Cb6bd7b9a-eadf-48f2-9232-260ac1bf2c10" priority="normal">
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="post" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C18011a5e-4bdd-4a36-9235-ed65c8929197" priority="normal">
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C971693cf-9a72-4128-85ed-87338b3c7288" priority="normal">
        <target>
            <property>
                <type name="ERoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Cdea13ccc-cf83-4aa5-ac9d-9c076505f176" priority="low">
        <target>
            <class>
                <type name="FormOfWayType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Die Code-Liste für FormOfWay
def codeList = 'http://inspire.ec.europa.eu/codelist/FormOfWayValue'

def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

collect.formOfWay.consume { key, values -&gt;
	def _id = 'FormOfWay_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	def valueGroups = _refLimit ? values.collate(_refLimit as int) : [values]
	def i = 1		
	valueGroups.each { valueGroup -&gt;
		def _id2 = _id 
		if (valueGroups.size &gt; 1) {
			// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
			_id2 += '_' + i++
		}
		_target {
			formOfWay {
				href( "$codeList/$key" )
			}
			id( _id2 )
			inspireId {
				Identifier {
					namespace( _ns )
					localId( _id2 )
				}
			}
			identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
				codeSpace( 'http://inspire.ec.europa.eu/ids' )
			}
			
			// Referenz zu gesammelten RoadLinks mit dieser Eigenschaft
			valueGroup.each { linkId -&gt;
				networkRef {
					NetworkReference {
						element {
							href( "#$linkId" )
						}
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `FormOfWay`-Objekt für jeden in den Daten vorkommenden Wert der [FormOfWayValue Code-Liste](http://inspire.ec.europa.eu/codelist/FormOfWayValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Code-Listen Wert gebildet, z.B. `FormOfWay_motorway`.

Es werden Referenzen (`NetworkReference`) zu allen Netzwerk-Elementen (z.B. `RoadLink`s und `RoadArea`s) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_Cdea13ccc-cf83-4aa5-ac9d-9c076505f176" priority="normal">
        <target>
            <property>
                <type name="FormOfWayType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_Cdea13ccc-cf83-4aa5-ac9d-9c076505f176" priority="normal">
        <target>
            <property>
                <type name="FormOfWayType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C76d28e9a-d217-4c2e-9b95-1597e9fe07de" priority="low">
        <target>
            <class>
                <type name="FunctionalRoadClassType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

// Erstelle ein FunctionalRoadClass-Objekt für jeden vorkommenden Wert
collect.functionalClass.consume { key, values -&gt;
	def _id = 'FunctionalRoadClass_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	def valueGroups = _refLimit ? values.collate(_refLimit as int) : [values]
	def i = 1		
	valueGroups.each { valueGroup -&gt;
		def _id2 = _id 
		if (valueGroups.size &gt; 1) {
			// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
			_id2 += '_' + i++
		}
		_target {
			functionalClass( key )
			id( _id2 )
			inspireId {
				Identifier {
					namespace( _ns )
					localId( _id2 )
				}
			}
			identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
				codeSpace( 'http://inspire.ec.europa.eu/ids' )
			}
			
			// Referenz zu gesammelten RoadLinks/RoadAreas mit dieser Eigenschaft
			valueGroup.each { linkId -&gt;
				networkRef {
					NetworkReference {
						element {
							href( "#$linkId" )
						}
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `FunctionalRoadClass`-Objekt für jeden in den Daten vorkommenden Wert für `functionalClass` (Enumeration).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem Attribut-Wert gebildet, z.B. `FunctionalRoadClass_mainRoad`.

Es werden Referenzen (`NetworkReference`) zu allen Netzwerk-Elementen (z.B. `RoadLink`s und `RoadArea`s) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C76d28e9a-d217-4c2e-9b95-1597e9fe07de" priority="normal">
        <target>
            <property>
                <type name="FunctionalRoadClassType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C76d28e9a-d217-4c2e-9b95-1597e9fe07de" priority="normal">
        <target>
            <property>
                <type name="FunctionalRoadClassType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source>
            <class>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
if (!_.geom.findPoints(_source.p.wkb_geometry.value())) {
	// Nur Objekte mit Punkt-Geometrien verwenden
	return
}

// ID des Quellobjekts
def sourceId = _source.p.gml_id.value()

def _id = "MarkerPost_$sourceId"
	
_target {
}

def collect
withTransformationContext {
	collect = _.context.collector(it)
	// Sammle ID für Netzwerk	
	//FIXME wird nicht zu Netzwerk hinzugefügt da aktuell nicht bekannt ist
	// zu welchem Netzwerk (Straße/Schiene) ein MarkerPost gehört
	//collect.network &lt;&lt; _id
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}
collect.verticalPosition[verticalPosition] &lt;&lt; _id

</core:text>
        </complexParameter>
        <documentation>Erstellt einen `MarkerPost` zu einer `AX_EinrichtungInOeffentlichenBereichen` mit Geometrie-Typ *GM_Point*, `art` *Kilometerstein, -tafel* (`1410`) und einer `kilometerangabe`.

*Hinweis:*

Der erstellte `MarkerPost` wird aktuell nicht dem Index von Netzwerk-Elementen hinzugefügt.
Um für eine `AX_EinrichtungInOeffentlichenBereichen` zu bestimmen, auf was für ein Objekt (z.B. Straße, Bahnstrecke) es sich bezieht, müsste eine geometrische Analyse vorgenommen werden die aktuell nicht Teil der Transformation ist. Deshalb werden in diesem Alignment alle `MarkerPost` aus `AX_EinrichtungInOeffentlichenBereichen`. Stattdessen sollte wo möglich der Bezug ermittelt werden und die entsprechenden `MarkerPost` auch dem entsprechenden `TransportNetwork` zugeordnet werden.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cce124c8f-8e7c-498c-9d01-a04f526147af_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source>
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cb7df5a6e-5206-42db-8b74-43600a5462ce_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source>
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C283ae5bb-6e8e-4493-b074-c68810c93f64" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C46d6c8f8-2fa7-411f-983a-f894528dcc5a_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source>
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="Point" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Inaccurate match of [type] http://www.adv-online.de/namespaces/adv/gid/7.1/AX_EinrichtungInOeffentlichenBereichenType/position/choice/Point to [type] jdbc:postgresql:testbed:public/ax_einrichtunginoeffentlichenbereichen/wkb_geometry via parent entity</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C83afa9d7-186c-4df3-b0ad-79672f3a17c3_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source name="id">
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Ccfbdb83c-2028-4682-b4d1-bc4c4a87f907_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source name="id">
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <target name="result">
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C2c8e10e4-55f9-410e-99b1-081b69c96388_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source name="id">
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C3822502c-ad98-403a-97e7-bc45057e9cad" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cb0fd2ad8-360a-46f4-b1c4-a932d628ddda_Cb090758a-65b1-49f7-a92e-42ef7d8afb04" priority="normal">
        <source>
            <property>
                <type name="ax_einrichtunginoeffentlichenbereichen" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">art = '1410' AND NOT (kilometerangabe IS NULL)</condition>
                </type>
                <child name="kilometerangabe"/>
            </property>
        </source>
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="location" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cfaa78fbf-05c9-420c-8a2b-52f9a5ebaeb7" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="location" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="uom"/>
            </property>
        </target>
        <parameter value="km" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C3ca73b7b-364f-402c-81ed-fe55f44463c4" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="route" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Ca2523e6e-1b8b-458d-95c6-47bf898786ec" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C3a3333de-7b30-45df-90fa-3e7f472a9fb5" priority="normal">
        <target>
            <property>
                <type name="MarkerPostType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Cf936785f-5456-4fc6-bd62-f55395169e5a" priority="low">
        <target>
            <class>
                <type name="NumberOfLanesType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

collect.numberOfLanes.eachCollector { _numberOfLanes, next -&gt;
	next.consume { _direction, linkIds -&gt;
		def _id = "NumberOfLanes_${_direction}_${_numberOfLanes}"
		def _ns = _project.vars.INSPIRE_NAMESPACE
		
		def directionRef = "http://inspire.ec.europa.eu/codelist/LinkDirectionValue/$_direction"

		def valueGroups = _refLimit ? linkIds.collate(_refLimit as int) : [linkIds]
		def i = 1		
		valueGroups.each { valueGroup -&gt;
			def _id2 = _id 
			if (valueGroups.size &gt; 1) {
				// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
				_id2 += '_' + i++
			}
			_target {
				numberOfLanes( _numberOfLanes )
				direction {
					href( directionRef )
				}
				id( _id2 )
				inspireId {
					Identifier {
						namespace( _ns )
						localId( _id2 )
					}
				}
				identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
					codeSpace( 'http://inspire.ec.europa.eu/ids' )
				}
				
				// Referenzen zu RoadLinks
				valueGroup.each { linkId -&gt;
					networkRef {
						NetworkReference {
							element {
								href( '#' + linkId )
							}
						}
					}
				}
			}
		}
	}
}

</core:text>
        </complexParameter>
        <documentation>Erstellt ein `NumberOfLanes`-Objekt für jede in den Daten vorkommende Kombination der Anzahl von Spuren (`numberOfLanes`) und der Richtung (`direction`, [LinkDirectionValue Code-Liste](http://inspire.ec.europa.eu/codelist/LinkDirectionValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart, der Richtung und der Anzahl von Spuren gebildet, z.B. `NumberOfLanes_bothDirections_2`.

Es werden Referenzen (`NetworkReference`) zu allen Netzwerk-Elementen (z.B. `RoadLink`s und `RoadArea`s) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_Cf936785f-5456-4fc6-bd62-f55395169e5a" priority="normal">
        <target>
            <property>
                <type name="NumberOfLanesType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cb01cca94-65d0-482e-8ddc-79381e266aef" priority="normal">
        <target>
            <property>
                <type name="NumberOfLanesType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="minMaxNumberOfLanes" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_Cf936785f-5456-4fc6-bd62-f55395169e5a" priority="normal">
        <target>
            <property>
                <type name="NumberOfLanesType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source>
            <class>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// nur Objekt mit flächenartigen Geometrien behandeln
def geometries = _.geom.findPolygons(_source.p.wkb_geometry.value())

// Ziel unterstützt keine MultiSurfaces
def surfaces = _.geom.splitMulti(geometries)

// Builder konfigurieren
// - Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

// Identifier des Quell-Objekts
def sourceId = _source.p.gml_id.value()

// bestimme FunctionalRoadClass
def functionalClass
switch (_source.p.artderfestlegung.value() as String) {
case '1110': // Bundesautobahn
	functionalClass = 'firstClass'
	break
case '1120': // Bundesstraße
	functionalClass = 'secondClass'
	break
case '1130': // Landes- oder Staatsstraße
	functionalClass = 'thirdClass'
	break
case '1140': // Kreisstraße
	functionalClass = 'fourthClass'
	break
case '1170': // Gemeindeverbindungsstraße
	functionalClass = 'fifthClass'
	break
case '1150': // Gemeindestraße
case '1160': // Ortsstraße
	functionalClass = 'sixthClass'
	break
case '1190': // Privatstraße
case '9997': // Attribut trifft nicht zu --&gt; aufgrund von Angaben in https://haleconnect.com/#/transformation/org/163/63acaf8b-ee09-4a0a-a1e2-635345224f07/tasks/8jg hinzugefügt
case '9999': // Sonstiges --&gt; aufgrund von Angaben in https://haleconnect.com/#/transformation/org/163/63acaf8b-ee09-4a0a-a1e2-635345224f07/tasks/8jg hinzugefügt
	functionalClass = 'ninthClass'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Ziel-Objekt für jede Fläche erstellen
int num = 1
surfaces.each { surface -&gt;
	// ID bestimmen
	def _id = "RoadArea_${sourceId}_${num}"
	def _ns = _project.vars.INSPIRE_NAMESPACE

	// Ziel-Objekt erstellen mit IDs und Geometrie
	_target {
		id( _id )
		inspireId {
			Identifier {
				localId( _id )
				namespace( _ns )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		geometry(surface)
	}
	
	// Sammle ID für Netzwerk
	collect.network &lt;&lt; _id
	// Sammle ID für FunctionalRoadClass
	if (functionalClass) {
		collect.functionalClass[functionalClass] &lt;&lt; _id
	}
	// Sammle ID für VerticalPosition
	collect.verticalPosition[verticalPosition] &lt;&lt; _id

	num++
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadArea`s aus `AX_KlassifizierungNachStrassenrecht`.

Die Geometrie des Quell-Objekts wird untersucht. Nur flächenartige Geometrien werden verwendet. Je Fläche wird eine `RoadArea` erzeugt.

Die lokale ID wird aus dem Namen der Ziel-Objektart, der AAA-ObjektID des Quell-Objekts und einer aufsteigenden Nummer der Fläche (1., 2., etc. Fläche der Geometrie) gebildet.

Die erstellte `RoadArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**FunctionalRoadClass**

Die *functionalClass* wird wie folgt aus dem Attribut `artDerFestlegung` ermittelt:

artDerFestlegung  | functionalClass
- | -
`1110` *(Bundesautobahn)* | `firstClass`
`1120` *(Bundesstraße)* | `secondClass`
`1130` *(Landes- oder Staatsstraße)* | `thirdClass`
`1140` *(Kreisstraße)* | `fourthClass`
`1170` *(Gemeindeverbindungsstraße)* | `fifthClass`
`1150` *(Gemeindestraße)* | `sixthClass`
`1190` *(Privatstraße)* | `ninthClass`

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source>
            <class>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadArea_' + _source.p.gml_id.value()

_target {
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadArea`s aus `AX_Platz` (nur `funktion` *Fußgängerzone*).

Die erstellte `RoadArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source>
            <class>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadArea_' + _source.p.gml_id.value()

_target {
}

// bestimme ConditionOfFacility
def conditionOfFacility = 'functional'
switch (_source.p.zustand.value() as String) {
case '2100': // Außer Betrieb, stillgelegt, verlassen
	conditionOfFacility = 'disused'
	break
case '4000': // Im Bau
	conditionOfFacility = 'underConstruction'
	break
case '8000': // Erweiterung, Neuansiedlung
	conditionOfFacility = 'projected'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für ConditionOfFacility
collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadArea`s aus `AX_Strassenverkehr` (falls `funktion` nicht gesetzt und für `funktion` *Verkehrsbegleitfläche Straße* und *Fußgängerzone*).

Die erstellte `RoadArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` ermittelt:

zustand  | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional`angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source>
            <class>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadArea_' + _source.p.gml_id.value()

_target {
}

// bestimme FunctionalRoadClass
def functionalClass
switch (_source.p.funktion.value() as String) {
case '5210': // Fahrweg
case '5212': // Wirtschaftsweg
	functionalClass = 'eighthClass'
	break
case '5211': // Hauptwirtschaftsweg
	functionalClass = 'seventhClass'
	break
case '5220': // Fußweg
case '5240': // Radweg
case '5250': // Rad- und Fußweg
	functionalClass = 'ninthClass'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für FunctionalRoadClass
if (functionalClass) {
	collect.functionalClass[functionalClass] &lt;&lt; _id
}
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadArea`s aus `AX_Weg` (alle Werte `funktion` außer *Reitweg*, *sonstige*, auch wenn kein Wert für `funktion` vorhanden ist).

Die erstellte `RoadArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**FunctionalRoadClass**

Die *functionalClass* wird wie folgt aus dem Attribut `funktion` ermittelt:

funktion  | functionalClass
- | -
`5210` *(Fahrweg)* | `eighthClass`
`5212` *(Wirtschaftsweg)* | `eighthClass`
`5211` *(Hauptwirtschaftsweg)* | `seventhClass`
`5220` *(Fußweg)* | `seventhClass`
`5240` *(Radweg)* | `seventhClass`
`5250` *(Rad- und Fußweg)* | `ninthClass`

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source>
            <class>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// nur Objekt mit flächenartigen Geometrien behandeln
def geometries = _.geom.findPolygons(_source.p.wkb_geometry.value())

// Ziel unterstützt keine MultiSurfaces
def surfaces = _.geom.splitMulti(geometries)

// Builder konfigurieren
// - Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

// Identifier des Quell-Objekts
def sourceId = _source.p.gml_id.value()

// bestimme FunctionalRoadClass
def functionalClass = 'ninthClass'

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Ziel-Objekt für jede Fläche erstellen
int num = 1
surfaces.each { surface -&gt;
	// ID bestimmen
	def _id = "RoadArea_${sourceId}_${num}"
	def _ns = _project.vars.INSPIRE_NAMESPACE

	// Ziel-Objekt erstellen
	_target {
		id( _id )
		inspireId {
			Identifier {
				localId( _id )
				namespace( _ns )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		geometry(surface)
	}
	
	// Sammle ID für Netzwerk
	collect.network &lt;&lt; _id
	// Sammle ID für FunctionalRoadClass
	if (functionalClass) {
		collect.functionalClass[functionalClass] &lt;&lt; _id
	}
	// Sammle ID für VerticalPosition
	collect.verticalPosition[verticalPosition] &lt;&lt; _id

	num++
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadArea`s aus `AX_WegPfadSteig` (nur `art` *Fußweg*, *Radweg* und *Rad- und Fußweg*).

Die Geometrie des Quell-Objekts wird untersucht. Nur flächenartige Geometrien verwendet. Je Fläche wird eine `RoadArea` erzeugt.

Die lokale ID wird aus dem Namen der Ziel-Objektart, der AAA-ObjektID des Quell-Objekts und einer aufsteigenden Nummer der Fläche (1., 2., etc. Fläche der Geometrie) gebildet.

Die erstellte `RoadArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**FunctionalRoadClass**

Die *functionalClass* wird fest als `ninthClass` angegeben.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc08e41ed-4753-4bff-880c-4e02752007c7_C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source>
            <property>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc08e41ed-4753-4bff-880c-4e02752007c7_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source>
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc08e41ed-4753-4bff-880c-4e02752007c7_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source>
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc08e41ed-4753-4bff-880c-4e02752007c7_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source>
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc08e41ed-4753-4bff-880c-4e02752007c7_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cbb136720-e720-41bb-b7e0-faa34263f64a_C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source>
            <property>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cbb136720-e720-41bb-b7e0-faa34263f64a_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source>
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cbb136720-e720-41bb-b7e0-faa34263f64a_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source>
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cbb136720-e720-41bb-b7e0-faa34263f64a_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source>
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cbb136720-e720-41bb-b7e0-faa34263f64a_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.AX_Lagebezeichnung.GeographicalName" id="C7701b354-25ce-49a5-baa7-ef1dce6f6bd0_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source name="lage_gemeinde">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="gemeinde"/>
            </property>
        </source>
        <source name="lage_kreis">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="kreis"/>
            </property>
        </source>
        <source name="lage_lage">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="lage"/>
            </property>
        </source>
        <source name="lage_land">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="land"/>
            </property>
        </source>
        <source name="lage_regierungsbezirk">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="regierungsbezirk"/>
            </property>
        </source>
        <source name="lage_unverschluesselt">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="unverschluesselt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">No match for entity [type] http://www.adv-online.de/namespaces/adv/gid/7.1/AX_PlatzType/name/AX_Lagebezeichnung found</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.AX_Lagebezeichnung.GeographicalName" id="C56863741-74c0-4bbe-a955-273776c6670e_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source name="lage_gemeinde">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="gemeinde"/>
            </property>
        </source>
        <source name="lage_kreis">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="kreis"/>
            </property>
        </source>
        <source name="lage_lage">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="lage"/>
            </property>
        </source>
        <source name="lage_land">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="land"/>
            </property>
        </source>
        <source name="lage_regierungsbezirk">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="regierungsbezirk"/>
            </property>
        </source>
        <source name="lage_unverschluesselt">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public"/>
                <child name="unverschluesselt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">No match for entity [type] http://www.adv-online.de/namespaces/adv/gid/7.1/AX_StrassenverkehrType/name/AX_Lagebezeichnung found</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.AX_Lagebezeichnung.GeographicalName" id="C8efb5887-8982-4d92-a666-4c4b1701e6a1_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source name="lage_gemeinde">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="gemeinde"/>
            </property>
        </source>
        <source name="lage_kreis">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="kreis"/>
            </property>
        </source>
        <source name="lage_lage">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="lage"/>
            </property>
        </source>
        <source name="lage_land">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="land"/>
            </property>
        </source>
        <source name="lage_regierungsbezirk">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="regierungsbezirk"/>
            </property>
        </source>
        <source name="lage_unverschluesselt">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public"/>
                <child name="unverschluesselt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">No match for entity [type] http://www.adv-online.de/namespaces/adv/gid/7.1/AX_WegType/name/AX_Lagebezeichnung found</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C97f8dc8e-cdff-4310-90c1-5a5fffea2ee4_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="high">
        <source name="spelling">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="bezeichnung"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C17a29f5c-b3aa-487a-b62d-46bccb2ce299_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="C03242cf4-d306-48d3-b28c-36ca110b9268_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="C14b7beec-415e-4a5e-bdf1-d522c580c2a7_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="Cfa221ae9-32f8-4cd2-a17e-e70893ce5865_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C4e7669e8-0669-46a5-9836-ff86d7f43672_C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C4e7669e8-0669-46a5-9836-ff86d7f43672_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C4e7669e8-0669-46a5-9836-ff86d7f43672_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C4e7669e8-0669-46a5-9836-ff86d7f43672_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source name="id">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C4e7669e8-0669-46a5-9836-ff86d7f43672_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C010d8324-6422-49f2-883a-7ee5d875177b_C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C010d8324-6422-49f2-883a-7ee5d875177b_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C010d8324-6422-49f2-883a-7ee5d875177b_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C010d8324-6422-49f2-883a-7ee5d875177b_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source name="id">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C010d8324-6422-49f2-883a-7ee5d875177b_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <target name="result">
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_C2581bae5-bd09-416c-948e-bcb8b5835ca3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_klassifizierungnachstrassenrecht" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_Ca20f2d64-1511-4c47-b43c-ea4f8f9cae05" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_C0f1c8732-7bcc-4843-abce-025a5c88d4f6" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IS NULL OR funktion = '2312') OR funktion = '2315') OR funktion = '5130'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_Cf0cb60dc-8399-4dd5-a7cc-03bba3ce2990" priority="normal">
        <source name="id">
            <property>
                <type name="ax_weg" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">NOT (funktion = '5260') AND NOT (funktion = '9999')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_C2827fa08-a3dd-4539-83de-413c6b922f47" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C87845354-a68e-4c9b-98a0-8d05883d4e0d" priority="normal">
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6d642b7a-9a3c-4e71-aec4-43534a1b7e3c" priority="normal">
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C5cbdfd0f-656b-4ab1-b556-a315cc806dc7" priority="normal">
        <target>
            <property>
                <type name="RoadAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.join" id="Cc8dfcac2-f330-4946-b4d6-8e1a87136c04" priority="normal">
        <source name="types">
            <class>
                <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="join">
            <jp:join-parameter xmlns:jp="http://www.esdi-humboldt.eu/hale/join">
                <class>
                    <type name="ax_strasse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <class>
                    <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <class>
                    <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
            </jp:join-parameter>
        </complexParameter>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Fahrbahnachsen werden präferiert als RoadLink für
// Strassen verwendet, alternativ verwende Strassenachsen


// Builder konfigurieren
// - Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

// ist die Fahrbahn getrennt?
def getrennt = (_source.p.fahrbahntrennung.value() as String) == '2000'

// bestimme FormOfWay
def formOfWay
def widmung = _source.p.widmung.value() as String
if (getrennt &amp;&amp; widmung != '1301') {
	formOfWay = 'dualCarriageway'
}
else if (getrennt &amp;&amp; widmung == '1301') {
	formOfWay = 'motorway'
}
else {
	formOfWay = 'singleCarriageway'
}

// bestimme RoadSurfaceCategory
// laut Mapping-Tabelle für alle 'paved'
def surfaceCategory = 'paved'

// bestimme FunctionalRoadClass
def functionalClass
switch (_source.p.widmung.value() as String) {
case '1301': // Bundesautobahn
	functionalClass = 'firstClass'
	break
case '1303': // Bundesstraße
	functionalClass = 'secondClass'
	break
case '1305': // Landesstraße, Staatsstraße
	functionalClass = 'thirdClass'
	break
case '1306': // Kreisstraße
	functionalClass = 'fourthClass'
	break
case '1307': // Gemeindestraße
	functionalClass = 'sixthClass'
	break
}
if (_source.p.internationalebedeutung.value() == '2001') {
	// internationaleBedeutung "überstimmt" Widmung
	functionalClass = 'mainRoad'
}

// Hilfsfunktion zum Erstellen eines RoadLink aus einer *achse
def erstelleRoadLink = { achse -&gt;
	boolean istFahrbahn = achse.definition.name.localPart.startsWith('ax_fahrbahn')

	def sourceId = achse.p.gml_id.value()
	def _id = "RoadLink_$sourceId"
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		endLifespanVersion( achse.p.endet.value() )
		beginLifespanVersion( achse.p.beginnt.value() )
		id( _id )
		def geoms = _.geom.toSimpleGeometries(geometries: achse.p.wkb_geometry.value(), collections: false)
		if (geoms.size() &gt; 1) {
			_log.error("Zusammenfassung von Geometrie in Achse ${sourceId} nicht möglich")
		}
		centrelineGeometry( geoms[0] )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		// dokumentiere Quell-Objektart
		description( 'Erstellt aus ' + achse.definition.name.localPart )
		
		// bestimme FormOfWay
		def formOfWayAchse = formOfWay
		if (achse.p.funktion.value() as String == '1808') { // Fußgängerzone
			formOfWayAchse = 'pedestrianZone'
		}
		
		// bestimme RoadWidth
		def breite = achse.p.breitederfahrbahn.value()
		def breiteUom = 'm' // gehe fest von m aus
		
		// bestimme NumberOfLanes
		def numberOfLanes = achse.p.anzahlderfahrstreifen.value()
		// http://inspire.ec.europa.eu/codelist/LinkDirectionValue
		def direction = istFahrbahn ? 'inDirection' : 'bothDirections'
		
		// bestimme ConditionOfFacility
		def conditionOfFacility = 'functional'
		switch (achse.p.zustand.value() as String) {
		case '2100': // Außer Betrieb, stillgelegt, verlassen
			conditionOfFacility = 'disused'
			break
		case '4000': // Im Bau
			conditionOfFacility = 'underConstruction'
			break
		}
		
		//bestimme TrafficFlowDirection
		def trafficFlowDirection

		if (achse.p.fahrtrichtung.value().toString() == 'true') {
			trafficFlowDirection = 'inDirection'
		}
		else if (achse.p.fahrtrichtung.value().toString() == 'false') {
			trafficFlowDirection = 'inOppositeDirection'
		}
		
		/*
		 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
		 */
		def untenRefs = achse.p.hatdirektunten.values()
		def verticalPositions = untenRefs.findResults { identifier -&gt;
			def bwf = collect.bauwerksfunktion[identifier].value() as String
			if (bwf) {
				switch (bwf) {
				// AX_BauwerkImVerkehrsbereich
				case '1800': // Brücke
				case '1801': // Mehrstöckige Brücke
				case '1802': // Bogenbrücke
				case '1803': // Fachwerkbrücke
				case '1804': // Hängebrücke
				case '1805': // Pontonbrücke
				case '1806': // Drehbrücke
				case '1807': // Hebebrücke
				case '1808': // Zugbrücke
				case '1820': // Steg
				case '1830': // Hochbahn, Hochstraße
				case '1890': // Schleusenkammer
				// AX_BauwerkImGewaesserbereich
				case '2030': // Staumauer
				case '2040': // Staudamm
				case '2050': // Wehr
				case '2060': // Sicherheitstor
				case '2080': // Sperrwerk
					return 'suspendedOrElevated'
				// AX_BauwerkImVerkehrsbereich
				case '1870': // Tunnel, Unterführung
				// AX_BauwerkImGewaesserbereich
				case '2010': // Durchlass
				case '2011': // Rohrdurchlass
				case '2012': // Düker
				case '2070': // Siel
				case '2090': // Schöpfwerk
					return 'underground'
				}
			}
			else {
				null
			}
		} as Set
		def verticalPosition
		if (!verticalPositions) {
			verticalPosition = 'onGroundSurface'
		}
		else {
			verticalPosition = verticalPositions.iterator().next()
			if (verticalPositions.size() &gt; 1) {
				_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
			}
		}
		
		// Sammle ID für Netzwerk	
		collect.network &lt;&lt; _id
		// Sammle ID für FormOfWay
		collect.formOfWay[formOfWayAchse] &lt;&lt; _id
		// Sammle ID für RoadSurfaceCategory
		collect.surfaceCategory[surfaceCategory] &lt;&lt; _id
		// Sammle Informationen für RoadWith
		if (breite) {
			collect.roadWidth &lt;&lt; [_id, breite, breiteUom]
		}
		// Sammle ID für NumberOfLanes
		if (numberOfLanes) {
			collect.numberOfLanes[numberOfLanes][direction] &lt;&lt; _id
		}
		// Sammle ID für FunctionalRoadClass
		if (functionalClass) {
			collect.functionalClass[functionalClass] &lt;&lt; _id
		}
		// Sammle ID für ConditionOfFacility
		collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
		// Sammle ID für TrafficFlowDirection
		if (trafficFlowDirection) {
			collect.trafficFlowDirection[trafficFlowDirection] &lt;&lt; _id
		}
		// Sammle ID für VerticalPosition
		collect.verticalPosition[verticalPosition] &lt;&lt; _id
	}
}

// Fahrbahnachsen

boolean hatFahrbahnachse = false

_source.links.ax_fahrbahnachse.each { achse -&gt;
	erstelleRoadLink(achse)

	hatFahrbahnachse = true
}

if (hatFahrbahnachse) {
	return
}

// keine Fahrbahnachsen, verwende Strassenachsen

boolean hatStrassenachse = false

_source.links.ax_strassenachse.each { achse -&gt;
	erstelleRoadLink(achse)

	hatStrassenachse = true
}

// keine Fahrbahnachsen oder Strassenachsen -&gt; keine Grundlage für RoadLink

if (!hatStrassenachse) {
	def strasseId = _source.p.gml_id.value()
	_log.warn("RoadLink: Strasse $strasseId hat weder Fahrbahnachsen noch Strassenachsen")
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadLink`s zu `AX_Strasse`.

Die zugehörigen `AX_Fahrbahnachse`n (nur Basis-DLM) und `AX_Strassenachse`n werden bestimmt.
Falls Fahrbahnachsen zu der Straße verfügbar sind werden diese zur Repräsentation der `RoadLink`s verwendet, andernfalls die Straßenachsen.

Je abzubildender Achse wird ein `RoadLink` erstellt.
Die lokale ID wird aus dem Namen der Ziel-Objektart (`RoadLink`) und der AAA-ObjektID der Achse gebildet (getrennt durch einen Unterstrich).
Geometrie und Lebenszeitintervall der Achse werden in den `RoadLink` übernommen.

Die erstellten `RoadLink`s werden dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**FormOfWay**

Die *formOfWay* wird wie folgt aus den Attributen `widmung` und `fahrbahntrennung` der Straße ermittelt:

Ist die Fahrbahn nicht getrennt ( *fahrbahntrennung != 2000* ) wird `singleCarriageway` verwendet.
Ist die Fahrbahn getrennt, wird der Wert auf Basis der Widmung bestimmt. Ist der Wert für Widmung Bundesautobahn (`1301`) wird `motorway` verwendet, andernfalls `dualCarriageway`.

**RoadSurfaceCategory**

Die *surfaceCategory* wird für alle Straßen als `paved` angenommen.

**FunctionalRoadClass**

Die *functionalClass* wird wie folgt aus den Attributen `internationaleBedeutung` und `widmung` der Straße ermittelt.
Ist die Straße eine Europastraße ( *internationaleBedeutung = 2001* ) wird `mainRoad` als Wert angenommen.
Andernfalls wird sie aus dem Attribut `widmung` wie folgt bestimmt:

widmung | functionalClass
- | -
`1301` *(Bundesautobahn)* | `firstClass`
`1303` *(Bundesstraße)* | `secondClass`
`1305` *(Landesstraße, Staatsstraße)* | `thirdClass`
`1306` *(Kreisstraße)* | `fourthClass`
`1307` *(Gemeindestraße)* | `sixthClass`

**FormOfWay**

Ist über das Attribut `funktion` der Achse feststellbar dass es sich um eine Fußgängerzone (`1808`) handelt, wird `pedestrianZone` als *formOfWay* hinterlegt.

**RoadWidth**

Die Information über die Fahrbahnbreite (Attribut `breiteDerFahrbahn` der Achse) wird falls vorhanden im Index hinterlegt.

**NumberOfLanes**

Die Information über die Anzahl der Fahrstreifen (Attribut `anzahlDerFahrstreifen` der Achse) wird falls vorhanden im Index hinterlegt.
Für Fahrbahnachsen wird als *direction* `inDirection` angegeben, für Straßenachsen `bothDirections`.

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` der Achse ermittelt:

zustand  | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional`angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Ca2c2e18b-a4f7-4f75-8f33-c9f97ac16b08" priority="normal">
        <source>
            <class>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadLink_' + _source.p.gml_id.value()

_target {
}

// bestimme FormOfWay
// -&gt; aus der Mapping-Tabelle geht kein Wert für Fahrwegachse hervor

// bestimme RoadSurfaceCategory
def surfaceCategory
switch (_source.p.befestigung.value() as String) {
case '1000': // Befestigt
	surfaceCategory = 'paved'
	break
case '2000': // Unbefestigt
	surfaceCategory = 'unpaved'
	break
}

// bestimme FunctionalRoadClass
def functionalClass
switch (_source.p.funktion.value() as String) {
case '5211': // Hauptwirtschaftsweg
	functionalClass = 'seventhClass'
	break
case '5212': // Wirtschaftsweg
	functionalClass = 'eighthClass'
	break
}

//bestimme AccessRestriction
def accessRestriction
switch (_source.p.befahrbarkeit.value() as String) {
case '2000': // Eingeschränkt befahrbar
	accessRestriction = 'seasonal'
	break
}

//bestimme TrafficFlowDirection
def trafficFlowDirection
if (_source.p.fahrtrichtung.value().toString() == 'true') {
	trafficFlowDirection = 'inDirection'
}
else if (_source.p.fahrtrichtung.value().toString() == 'false') {
	trafficFlowDirection = 'inOppositeDirection'
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für RoadSurfaceCategory
if (surfaceCategory) {
	collect.surfaceCategory[surfaceCategory]
}
// Sammle ID für FunctionalRoadClass
if (functionalClass) {
	collect.functionalClass[functionalClass] &lt;&lt; _id
}
// Sammle ID für AccessRestriction
if (accessRestriction) {
	collect.accessRestriction[accessRestriction] &lt;&lt; _id
}
// Sammle ID für TrafficFlowDirection
if (trafficFlowDirection) {
	collect.trafficFlowDirection[trafficFlowDirection] &lt;&lt; _id
}
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt einen `RoadLink` aus einer `AX_Fahrwegachse`.

Der erstellte `RoadLink` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**RoadSurfaceCategory**

Die *surfaceCategory* wird wie folgt aus dem Attribut `befestigung` ermittelt:

befestigung  | surfaceCategory
- | -
`1000` *(Befestigt)* | `paved`
`2000` *(Unbefestigt)* | `unpaved`

**FunctionalRoadClass**

Die *functionalClass* wird wie folgt aus dem Attribut `funktion` ermittelt:

funktion  | functionalClass
- | -
`5211` *(Hauptwirtschaftsweg)* | `seventhClass`
`5212` *(Wirtschaftsweg)* | `eighthClass`

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C3296f18d-e980-40cf-a9f3-9e5187ecf16a" priority="normal">
        <source>
            <class>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// nur Objekt mit linienartigen Geometrien behandeln
def geometries = _.geom.findLines(_source.p.wkb_geometry.value())

// Ziel unterstützt keine MultiLineStrings
def curves = _.geom.toSimpleGeometries(geometries: geometries, collections: false)

// Builder konfigurieren
// - Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

// Identifier des Quell-Objekts
def sourceId = _source.p.gml_id.value()

// bestimme FormOfWay
def formOfWay
def art = _source.p.art.value() as String
switch (art) {
case '1106': // Radweg
case '1110': // Rad- und Fußweg
	formOfWay = 'bicycleRoad'
	break
case '1103': // Fußweg
	formOfWay = 'walkway'
	break
}

// bestimme RoadSurfaceCategory
def surfaceCategory
switch (_source.p.befestigung.value() as String) {
case '1000': // Befestigt
	surfaceCategory = 'paved'
	break
case '2000': // Unbefestigt
	surfaceCategory = 'unpaved'
	break
}

// bestimme FunctionalRoadClass
def functionalClass = 'ninthClass'

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Ziel-Objekt für jede Linie erstellen
int num = 1
curves.each { curve -&gt;
	// ID bestimmen
	def _id = "RoadLink_${sourceId}_${num}"
	def _ns = _project.vars.INSPIRE_NAMESPACE

	// Ziel-Objekt erstellen
	_target {
		id( _id )
		inspireId {
			Identifier {
				localId( _id )
				namespace( _ns )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		centrelineGeometry(curve)
	}
	
	
	// Sammle ID für Netzwerk	
	collect.network &lt;&lt; _id
	// Sammle ID für FormOfWay
	if (formOfWay) {
		collect.formOfWay[formOfWay] &lt;&lt; _id
	}
	// Sammle ID für RoadSurfaceCategory
	if (surfaceCategory) {
		collect.surfaceCategory[surfaceCategory] &lt;&lt; _id
	}
	// Sammle ID für FunctionalRoadClass
	if (functionalClass) {
		collect.functionalClass[functionalClass] &lt;&lt; _id
	}
	// Sammle ID für VerticalPosition
	collect.verticalPosition[verticalPosition] &lt;&lt; _id
	
	num++
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadLink`s aus `AX_WegPfadSteig` (nur `art` *Fußweg*, *Radweg* und *Rad- und Fußweg*).

Die Geometrie des Quell-Objekts wird untersucht. Nur linienartige Geometrien werden verwendet. Je individueller Geometrie wird ein `RoadLink` erzeugt.

Die lokale ID wird aus dem Namen der Ziel-Objektart, der AAA-ObjektID des Quell-Objekts und einer aufsteigenden Nummer der individuellen Geometrien (1., 2., Geometrie) gebildet.

Der erstellte `RoadLink` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**FormOfWay**

Die *formOfWay* wird wie folgt aus dem Attribut `art` ermittelt:

art  | formOfWay
- | -
`1106` *(Radweg)* | `bicycleRoad`
`1110` *(Rad- und Fußweg)* | `bicycleRoad`
`1103` *(Fußweg)* | `walkway`

**RoadSurfaceCategory**

Die *surfaceCategory* wird wie folgt aus dem Attribut `befestigung` ermittelt:

befestigung  | surfaceCategory
- | -
`1000` *(Befestigt)* | `paved`
`2000` *(Unbefestigt)* | `unpaved`

**FunctionalRoadClass**

Die *functionalClass* wird als `ninthClass` festgelegt.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ceb60a943-e6d4-45c8-8692-2509eb1a7320" priority="normal">
        <source>
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ce6f245ee-1436-45f8-a16d-78424c92b543_C3296f18d-e980-40cf-a9f3-9e5187ecf16a" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="Cea0e0475-9496-4b4f-92a9-6f2a1d12bc85" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="centrelineGeometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C28de3162-ee30-4e33-a023-c790c0626889" priority="normal">
        <source>
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cf2ebdda1-3be7-4874-b722-5771fb39d520_C3296f18d-e980-40cf-a9f3-9e5187ecf16a" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cb21be42b-6ddb-448b-b3b3-bbf7b68a463d" priority="normal">
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="fictitious" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="Ca2037be2-6ca4-4d8b-9f8c-0ca7b00923b0" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C1187dcaa-1077-4af5-8635-a8d4afd72e05" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public"/>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="Cc282d381-71a7-42c0-ad00-3db811354191_C3296f18d-e980-40cf-a9f3-9e5187ecf16a" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ca2b6c098-4854-4d90-a534-81d0f7c5ad8b" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Cdd81c01e-7dae-452d-b14f-7c8f76f43c67" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cc8dfcac2-f330-4946-b4d6-8e1a87136c04" priority="normal">
        <target name="result">
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C0720c2b6-cc98-42b3-9407-05b4b5cdb1b8" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="Ca75e7935-ff63-4356-909a-b59d866bc062" priority="normal">
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C7e730557-eed5-41b1-9e74-ceb423099aeb" priority="normal">
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C7064efe2-85ca-4004-b2ee-1b11aab69401" priority="normal">
        <target>
            <property>
                <type name="RoadLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source>
            <class>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
def _id = 'RoadServiceArea_' + _source.p.gml_id.value()&#13;
&#13;
_target {&#13;
}&#13;
// bestimme ConditionOfFacility&#13;
def conditionOfFacility = 'functional'&#13;
switch (_source.p.zustand.value()) {&#13;
case '2100': // Außer Betrieb, stillgelegt, verlassen&#13;
	conditionOfFacility = 'disused'&#13;
	break&#13;
}&#13;
&#13;
/*&#13;
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition&#13;
 */&#13;
def untenRefs = _source.p.hatDirektUnten.href.values()&#13;
def verticalPositions = untenRefs.findResults { identifier -&gt;&#13;
	def bwf = collect.bauwerksfunktion[identifier].value()&#13;
	if (bwf) {&#13;
		switch (bwf) {&#13;
		// AX_BauwerkImVerkehrsbereich&#13;
		case '1800': // Brücke&#13;
		case '1801': // Mehrstöckige Brücke&#13;
		case '1802': // Bogenbrücke&#13;
		case '1803': // Fachwerkbrücke&#13;
		case '1804': // Hängebrücke&#13;
		case '1805': // Pontonbrücke&#13;
		case '1806': // Drehbrücke&#13;
		case '1807': // Hebebrücke&#13;
		case '1808': // Zugbrücke&#13;
		case '1820': // Steg&#13;
		case '1830': // Hochbahn, Hochstraße&#13;
		case '1890': // Schleusenkammer&#13;
		// AX_BauwerkImGewaesserbereich&#13;
		case '2030': // Staumauer&#13;
		case '2040': // Staudamm&#13;
		case '2050': // Wehr&#13;
		case '2060': // Sicherheitstor&#13;
		case '2080': // Sperrwerk&#13;
			return 'suspendedOrElevated'&#13;
		// AX_BauwerkImVerkehrsbereich&#13;
		case '1870': // Tunnel, Unterführung&#13;
		// AX_BauwerkImGewaesserbereich&#13;
		case '2010': // Durchlass&#13;
		case '2011': // Rohrdurchlass&#13;
		case '2012': // Düker&#13;
		case '2070': // Siel&#13;
		case '2090': // Schöpfwerk&#13;
			return 'underground'&#13;
		}&#13;
	}&#13;
	else {&#13;
		null&#13;
	}&#13;
} as Set&#13;
&#13;
def verticalPosition&#13;
if (!verticalPositions) {&#13;
	verticalPosition = 'onGroundSurface'&#13;
}&#13;
else {&#13;
	verticalPosition = verticalPositions.iterator().next()&#13;
	if (verticalPositions.size() &gt; 1) {&#13;
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)&#13;
	}&#13;
}&#13;
&#13;
// Sammle ID für Netzwerk&#13;
collect.network &lt;&lt; _id&#13;
&#13;
// Sammle ID für RoadServiceType&#13;
collect.roadServiceTypeParking &lt;&lt; _id&#13;
&#13;
&#13;
// Sammle ID für ConditionOfFacility&#13;
collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id&#13;
&#13;
// Sammle ID für VerticalPosition&#13;
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source>
            <class>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadServiceArea_' + _source.p.gml_id.value()

_target {
}

// bestimme RoadServiceType
def serviceType
switch (_source.p.funktion.value() as String) {
case '5360': // Busbahnhof
	serviceType = 'busStation'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für RoadServiceType
if (serviceType) {
	collect.serviceType[serviceType] &lt;&lt; _id
}
// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadServiceArea` aus `AX_Platz` (nur `funktion` *Rastplatz*, *Raststätte* und *Parkplatz*).

Die erstellte `RoadServiceArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source>
            <class>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RoadServiceArea_' + _source.p.gml_id.value()

_target {
}

// bestimme ConditionOfFacility
def conditionOfFacility = 'functional'
switch (_source.p.zustand.value() as String) {
case '2100': // Außer Betrieb, stillgelegt, verlassen
	conditionOfFacility = 'disused'
	break
case '4000': // Im Bau
	conditionOfFacility = 'underConstruction'
	break
case '8000': // Erweiterung, Neuansiedlung
	conditionOfFacility = 'projected'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatdirektunten.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value() as String
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für ConditionOfFacility
collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt `RoadServiceArea` aus `AX_Strassenverkehr` (nur `funktion` *Gebäude- und Freifläche zu Verkehrsanlagen, Straße* und *Straßenentwässerungsanlage*).

Die erstellte `RoadServiceArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` ermittelt:

zustand  | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional`angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C061eaac0-9374-4b3e-b1e9-d153a8be91b5_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source>
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C061eaac0-9374-4b3e-b1e9-d153a8be91b5_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source>
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C061eaac0-9374-4b3e-b1e9-d153a8be91b5_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source>
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C3c8f6f33-db96-4b93-8daa-93234f9b54d9" priority="normal">
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="unknown" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cfcddb090-1dd1-47f2-b215-20490d0372cc_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source>
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cfcddb090-1dd1-47f2-b215-20490d0372cc_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source>
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cfcddb090-1dd1-47f2-b215-20490d0372cc_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source>
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C29af463b-32e7-4faf-9c91-7d222cbc6030" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.AX_Lagebezeichnung.GeographicalName" id="C99266668-af5a-41d1-8c0f-761ef6877469_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source name="lage_gemeinde">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="gemeinde"/>
            </property>
        </source>
        <source name="lage_kreis">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="kreis"/>
            </property>
        </source>
        <source name="lage_lage">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="lage"/>
            </property>
        </source>
        <source name="lage_land">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="land"/>
            </property>
        </source>
        <source name="lage_regierungsbezirk">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="regierungsbezirk"/>
            </property>
        </source>
        <source name="lage_unverschluesselt">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public"/>
                <child name="unverschluesselt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">No match for entity [type] http://www.adv-online.de/namespaces/adv/gid/7.1/AX_PlatzType/name/AX_Lagebezeichnung found</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="C073255ea-ac1a-4066-965a-7aa87cc9babc" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="Cd93d26ce-75f5-4a6a-9d4f-5e15f288d6f8_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="Cabfa9b04-be6c-4af3-a77c-09348ea070a1_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source name="geometrie">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="wkb_geometry"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C28588120-6d5c-4d16-b0e8-2b7a10d53c4c_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source name="id">
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C28588120-6d5c-4d16-b0e8-2b7a10d53c4c_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C28588120-6d5c-4d16-b0e8-2b7a10d53c4c_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C36b5c984-cffc-4e48-98fe-38cd877b5b8e_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source name="id">
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C36b5c984-cffc-4e48-98fe-38cd877b5b8e_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C36b5c984-cffc-4e48-98fe-38cd877b5b8e_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <target name="result">
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <target name="result">
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C63af76cc-1c77-4b8e-b20c-c63b749b972b_Cab1f0844-ca2a-404f-818b-c72553e7a069" priority="normal">
        <source name="id">
            <property>
                <type name="ax_flaechebesondererfunktionalerpraegung" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">funktion = 1200</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C63af76cc-1c77-4b8e-b20c-c63b749b972b_C2676fc94-d50d-4c45-b5b1-e4301a9cfe4a" priority="normal">
        <source name="id">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C63af76cc-1c77-4b8e-b20c-c63b749b972b_C2f3a385b-d4d3-4a1e-9999-296f10a58386" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strassenverkehr" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">(funktion IN ('2311','2313')) OR funktion = '2314'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="Cffee451b-b8bd-4701-8077-cb5cca34261a" priority="normal">
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C12007973-d14d-476a-b70f-defa22c4688a" priority="normal">
        <target>
            <property>
                <type name="RoadServiceAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd" priority="lower">
        <target>
            <class>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
//collect.roadServiceType &lt;&lt; _source.p.funktion.value()&#13;
&#13;
if (!collect.roadServiceType.values().contains('5310')){&#13;
	_target {&#13;
		beginLifespanVersion( ) {&#13;
			nilReason( 'other:unpopulated' )&#13;
		}&#13;
		id( 'RoadServiceType_parking' )&#13;
		validFrom( ) {&#13;
			nilReason( 'other:unpopulated' )&#13;
		}&#13;
		collect.roadServiceTypeParking.each { flaeche -&gt;&#13;
			networkRef {&#13;
				NetworkReference{&#13;
					element {&#13;
						href('#' + flaeche)&#13;
					}&#13;
				}&#13;
			}&#13;
		}&#13;
		identifier( _project.vars.INSPIRE_NAMESPACE + 'RoadServiceType_parking' ) {&#13;
			codeSpace( 'http://inspire.ec.europa.eu/ids' )&#13;
		}&#13;
		inspireId {&#13;
			Identifier {&#13;
				namespace( _project.vars.INSPIRE_NAMESPACE )&#13;
				localId( 'RoadServiceType_parking' )&#13;
			}&#13;
		}&#13;
		type {&#13;
			href( 'http://inspire.ec.europa.eu/codelist/RoadServiceTypeValue/parking' )&#13;
		}&#13;
	}&#13;
}
</core:text>
        </complexParameter>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.merge" id="C7167685d-1927-4e65-82f3-b01258f955b4" priority="low">
        <source>
            <class>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <parameter value="false" name="auto_detect"/>
        <parameter value="funktion" name="property"/>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
collect.roadServiceType &lt;&lt; _source.p.funktion.value()&#13;
&#13;
_target{}
</core:text>
        </complexParameter>
        <documentation>`AX_Platz` mit gleicher `funktion` werden zusammengefasst um den `RoadServiceType` für die entsprechenden `RoadServiceArea`s zu bilden.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="Cccc9812b-cbe4-47a6-ab03-5e4e8e237b2f_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0">
                    <context>0</context>
                </child>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/drinks" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="C82f4f042-2fa9-48f2-9212-1607e76c1fe1_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0">
                    <context>1</context>
                </child>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/food" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="Cebd7cdea-2694-4960-89ef-1cbc876bb136_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0">
                    <context>2</context>
                </child>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/fuel" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="C194d59be-3cd4-4730-9280-b7159a68190f_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0">
                    <context>3</context>
                </child>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/shop" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="Cbe1e3f30-5acf-4eb2-85e2-e51713896d7b_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0">
                    <context>4</context>
                </child>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/toilets" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="C764250f9-a589-443e-b75b-b19525bc4a25_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="CQL">value = '5320' or value = '5330'</condition>
                </child>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="availableFacility" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/ServiceFacilityValue/picnicArea" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd" priority="normal">
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="C16d977ed-3a0e-450d-9304-e5b9ab61d589_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.formattedstring" id="C06c4fa21-f02d-428e-9a48-6de08e035852_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="var">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="RoadServiceType_{funktion}" name="pattern"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C2f39c383-6a2c-4d96-86fa-13b70fb05164_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="var">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target name="result">
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def _id = "RoadServiceType_${funktion}"
def _ns = _project.vars.INSPIRE_NAMESPACE

_target( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
	codeSpace( 'http://inspire.ec.europa.eu/ids' )
}
</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.formattedstring" id="C2144d1d2-7e84-480c-88f5-69b8d027ea97_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="var">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="RoadServiceType_{funktion}" name="pattern"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C926d15b8-a481-4947-a796-ae74e3d6e3d7" priority="normal">
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="Cb23dec73-0344-4ce3-8680-f66ef3dd2625_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="{{project:INSPIRE_NAMESPACE}}" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C5751a76b-1feb-4a49-9cd3-1eec3fe57799_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="var">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion">
                    <condition lang="ECQL">value = '5310'</condition>
                </child>
            </property>
        </source>
        <target name="result">
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="networkRef" ns="http://inspire.ec.europa.eu/schemas/net/4.0">
                    <context>0</context>
                </child>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
if(!funktion){&#13;
	throw new NoResultException()&#13;
}&#13;
&#13;
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
//_ids = ['RoadArea_1', 'RoadArea_2']&#13;
&#13;
collect.roadServiceTypeParking.each { flaeche -&gt;&#13;
//_ids.each { flaeche -&gt;&#13;
_log.info('Schleife läuft für ' + flaeche)&#13;
	_target {&#13;
		NetworkReference {&#13;
			//NetworkReference{	&#13;
				element {&#13;
					href ('#' + flaeche)&#13;
					_log.info('href erzeugt für ' + flaeche)&#13;
				}&#13;
			//}&#13;
		}&#13;
	}&#13;
}&#13;
&#13;
/*_target {&#13;
		NetworkReference {&#13;
			//NetworkReference{	&#13;
				element {&#13;
					href ('#id')&#13;
				}&#13;
			//}&#13;
		}&#13;
	}*/
</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.formattedstring" id="C52ac1d6a-4b79-4afa-988a-ff6f351d3c52_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="var">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="networkRef" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="choice" ns="http://inspire.ec.europa.eu/schemas/net/4.0/NetworkReference"/>
                <child name="NetworkReference" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="element" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="#RoadServiceArea_{gml_id}" name="pattern"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.classification" id="Cb822d066-69fc-4cf8-8d8d-7e957bf43384_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source>
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="type" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="lookupTable">
            <lookup-table xmlns:ns2="http://www.esdi-humboldt.eu/hale/alignment" xmlns="">
                <entry>
                    <key value="5330"/>
                    <value value="http://inspire.ec.europa.eu/codelist/RoadServiceTypeValue/restArea"/>
                </entry>
                <entry>
                    <key value="5320"/>
                    <value value="http://inspire.ec.europa.eu/codelist/RoadServiceTypeValue/restArea"/>
                </entry>
                <entry>
                    <key value="5310"/>
                    <value value="http://inspire.ec.europa.eu/codelist/RoadServiceTypeValue/parking"/>
                </entry>
                <entry>
                    <key value="5360"/>
                    <value value="http://inspire.ec.europa.eu/codelist/RoadServiceTypeValue/busStation"/>
                </entry>
            </lookup-table>
        </complexParameter>
        <parameter value="null" name="notClassifiedAction"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd" priority="normal">
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign.bound" id="C76b7838c-63ba-405d-b3d8-4e82221002a8_C7167685d-1927-4e65-82f3-b01258f955b4" priority="normal">
        <source name="anchor">
            <property>
                <type name="ax_platz" ns="jdbc:postgresql:testbed:public">
                    <condition lang="ECQL">((funktion IN ('5320','5330')) OR funktion = '5310') OR funktion = '5360'</condition>
                </type>
                <child name="funktion"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadServiceTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C58fab7dc-5037-41c6-97cd-b69550c0ec51" priority="low">
        <target>
            <class>
                <type name="RoadSurfaceCategoryType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Die Code-Liste für RoadSurfaceCategory
def codeList = 'http://inspire.ec.europa.eu/codelist/RoadSurfaceCategoryValue'

def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

collect.surfaceCategory.consume { key, values -&gt;
	def _id = 'RoadSurfaceCategory_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE

	def valueGroups = _refLimit ? values.collate(_refLimit as int) : [values]
	def i = 1		
	valueGroups.each { valueGroup -&gt;
		def _id2 = _id 
		if (valueGroups.size &gt; 1) {
			// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
			_id2 += '_' + i++
		}
		_target {
			surfaceCategory {
				href( "$codeList/$key" )
			}
			id( _id2 )
			inspireId {
				Identifier {
					namespace( _ns )
					localId( _id2 )
				}
			}
			identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
				codeSpace( 'http://inspire.ec.europa.eu/ids' )
			}
			
			// Referenz zu gesammelten RoadLinks mit dieser Eigenschaft
			valueGroup.each { linkId -&gt;
				networkRef {
					NetworkReference {
						element {
							href( "#$linkId" )
						}
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RoadSurfaceCategory`-Objekt für jeden in den Daten vorkommenden Wert der [RoadSurfaceCategoryValue Code-Liste](http://inspire.ec.europa.eu/codelist/RoadSurfaceCategoryValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Code-Listen Wert gebildet, z.B. `RoadSurfaceCategory_paved`.

Es werden Referenzen (`NetworkReference`) zu allen Netzwerk-Elementen (z.B. `RoadLink`s und `RoadArea`s) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C58fab7dc-5037-41c6-97cd-b69550c0ec51" priority="normal">
        <target>
            <property>
                <type name="RoadSurfaceCategoryType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C58fab7dc-5037-41c6-97cd-b69550c0ec51" priority="normal">
        <target>
            <property>
                <type name="RoadSurfaceCategoryType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.join" id="Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source name="types">
            <class>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <source name="types">
            <class>
                <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="join">
            <jp:join-parameter xmlns:jp="http://www.esdi-humboldt.eu/hale/join">
                <class>
                    <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                        <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                    </type>
                </class>
                <class>
                    <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <class>
                    <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                </class>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                            <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                        </type>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_fahrbahnachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
                <jp:condition>
                    <property>
                        <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                            <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                        </type>
                        <child name="gml_id"/>
                    </property>
                    <property>
                        <type name="ax_strassenachse" ns="jdbc:postgresql:testbed:public"/>
                        <child name="istteilvon"/>
                    </property>
                </jp:condition>
            </jp:join-parameter>
        </complexParameter>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Strasse nach Road -&gt; stelle Verknpüfung zu RoadLinks her

// Fahrbahnachsen werden präferiert als RoadLink für
// Strassen verwendet, alternativ verwende Strassenachsen

boolean hatFahrbahnachse = !!_source.links.ax_fahrbahnachse.first()
boolean hatStrassenachse = !!_source.links.ax_strassenachse.first()

def strasseId = _source.p.gml_id.value()
if (!hatFahrbahnachse &amp;&amp; !hatStrassenachse) {
	_log.warn("Road: Strasse $strasseId hat weder Fahrbahnachsen noch Strassenachsen")
	throw new NoResultException('Kann kein Road-Objekt ohne RoadLinks erstellen')
}

// erstelle Road

_target {
	if (hatFahrbahnachse) {
		_source.links.ax_fahrbahnachse.each { achse -&gt;
			link {
				href( '#RoadLink_' + achse.p.gml_id.value() )
			}
		}
	}
	else if (hatStrassenachse) {
		_source.links.ax_strassenachse.each { achse -&gt;
			link {
				href( '#RoadLink_' + achse.p.gml_id.value() )
			}
		}
	}
}

// Sammle ID für Netzwerk
withTransformationContext {
	_.context.collector(it).network &lt;&lt; 'Road_' + strasseId
}

</core:text>
        </complexParameter>
        <documentation>Erstellt `Road`s zu `AX_Strasse`. Berücksichtig werden Straßen die keine Europastraßen sind (welche nach `ERoad` abgebildet werden).

Die zugehörigen `AX_Fahrbahnachse`n (nur Basis-DLM) und `AX_Strassenachse`n werden bestimmt um die Verknüpfung zu den entsprechend zu erstellenden `RoadLink`-Objekten herstellen zu können (in der Eigenschaft `link`).
Falls Fahrbahnachsen zu der Straße verfügbar sind werden diese zur Repräsentation der `RoadLink`s verwendet, andernfalls die Straßenachsen.

Die erstellte `Road` wird dem Index von Netzwerk-Elementen hinzugefügt.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C3d378c6d-c4c0-4bfe-9748-be28f5908f38" priority="normal">
        <source>
            <class>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def _id = 'Road_' + _source.p.gml_id.value()

_target {
}

// Sammle ID für Netzwerk
withTransformationContext {
	_.context.collector(it).network &lt;&lt; _id
}

</core:text>
        </complexParameter>
        <documentation>Erstellt je eine `Road` zu einer `AX_Fahrwegachse`.

Die erstellte `Road` wird dem Index von Netzwerk-Elementen hinzugefügt.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source>
            <class>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// nur Objekt mit linienartigen Geometrien behandeln
// welche einen RoadLink repräsentieren
def geometries = _.geom.findLines(_source.p.wkb_geometry.value())

// RoadLinks werden aus den individuellen Geometrien gebildet
def curves = _.geom.toSimpleGeometries(geometries: geometries, collections: false)

if (curves) {
	// erstelle eine Road nur wenn linienartige Geometrien
	// vorhanden sind (andernfalls wird es eine RoadArea)

	// Identifier des Quell-Objekts
	def sourceId = _source.p.gml_id.value()
	
	_target {
		// Verweis auf individuelle RoadLinks erstellen
		int num = 1
		curves.each { curve -&gt;
			// ID bestimmen
			def ref = "#RoadLink_${sourceId}_${num}"
			link {
				href( ref )
			}
			
			num++
		}
	}
	
	// Sammle ID für Netzwerk
	withTransformationContext {
		_.context.collector(it).network &lt;&lt; "Road_$sourceId"
	}

}
</core:text>
        </complexParameter>
        <documentation>Erstellt eine `Road`s aus `AX_WegPfadSteig` (nur `art` *Fußweg*, *Radweg* und *Rad- und Fußweg*).

*Die Bedingung weicht von der Angabe in der vorgegebenen Mapping-Tabelle ab (alle AX_WegPfadSteig), wurde jedoch angepasst an die Vorgaben zu RoadLink, da eine Road aus mindestens einem RoadLink bestehen muss.*

Die Geometrie des Quell-Objekts wird untersucht. Nur linienartige Geometrien sind relevant, da aus diesen an anderer Stelle entsprechende `RoadLink`s erstellt werden. Die Verknüpfung zu diesen `RoadLink`s wird hier hergestellt (in der Eigenschaft `link`).

Die erstellte `Road` wird dem Index von Netzwerk-Elementen hinzugefügt.</documentation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">The cell's source entities have been replaced, the new entities may have a different structure and/or names and may require updating the Groovy script accordingly</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ce6146fb9-6ab3-4d76-a0f8-ebf3c9e66667" priority="normal">
        <source>
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cf04bf7cb-0c75-4a85-a346-ff2791070e27_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C43612668-3d9d-4857-ac31-d510c15bc312_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="beginnt"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C957cc3cc-ece3-459a-9ab0-61b8dc612bcd" priority="normal">
        <source>
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ca5cd019b-6e90-4f57-b478-94908d192233_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C9503659f-1365-4672-8cfb-1600e40207a5_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="endet"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="Cedb16141-aec0-4c8d-a70a-302e12648ea7_C3d378c6d-c4c0-4bfe-9748-be28f5908f38" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C055eee92-8f70-4d3b-9771-2b7346cd7f6f_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C71badf51-3d25-4822-a1b3-c342ce7dd357_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source name="spelling">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="name"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Cd8e7f411-44b2-422e-8f5e-09112b56e2a1" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C5855cff4-b320-4f0c-bd53-c8d282791687_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C92e8561d-980c-40f4-aa8e-834f628f8e3d_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Ccec81252-a0b4-4f4a-b6cf-1859e4cd3223" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C683c368a-e836-4ee4-9c47-abce43294ae6_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Cc4d83d5a-b9af-4a97-ad33-d69a0e2777b8_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <target name="result">
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inNetwork" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">'#' + _project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Verknüpft das Netzwerk-Element mit dem entsprechenden *TransportNetwork*.
Dazu wird die vorgegebene ID für das Netzwerk verwendet (Projekt-Variable).</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C25b81492-3b0f-4ffb-be0e-7ff925713e47" priority="normal">
        <source name="id">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C8a40758b-371a-4883-9294-1adafd5bc376_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source name="id">
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Cde61c643-ff7b-4c72-9383-b958edf7654d_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source name="id">
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="true" name="useTargetTypePrefix"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.formattedstring" id="C1505c26d-f446-4fad-8d7f-bc3fd3448caf" priority="normal">
        <source name="var">
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="gml_id"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="link" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="#RoadLink_{gml_id}" name="pattern"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C713718d5-a92b-4d39-a5e8-b55d5d88aca8" priority="normal">
        <source>
            <property>
                <type name="ax_fahrwegachse" ns="jdbc:postgresql:testbed:public"/>
                <child name="strassenschluessel"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="localRoadCode" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Ce681d243-749e-4941-ab0d-02a2b7d3b7ec_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="strassenschluessel"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="localRoadCode" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C15dccdb1-4388-4632-a0b2-c40a9f31b855_C949d36a1-b1e9-4c1d-9fab-584d6ff7bee2" priority="normal">
        <source>
            <property>
                <type name="ax_wegpfadsteig" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">(art = '1103' OR art = '1106') OR art = '1110'</condition>
                </type>
                <child name="strassenschluessel"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="localRoadCode" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C3966b6d7-6d7f-4015-989d-68838f82deb5_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <source>
            <property>
                <type name="ax_strasse" ns="jdbc:postgresql:testbed:public">
                    <condition lang="CQL">internationalebedeutung IS NULL OR NOT (internationalebedeutung = '2001')</condition>
                </type>
                <child name="bezeichnung"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="nationalRoadCode" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
        <annotation type="message">
            <core:message xmlns:core="http://www.esdi-humboldt.eu/hale/core" category="migration">
                <core:content>
                    <core:text xml:space="preserve">Filter condition may not be valid because the entity it is applied to has been replaced</core:text>
                </core:content>
            </core:message>
        </annotation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6da68b64-b734-429c-acd4-bd1fd5b68db1_Ca487d3fe-c4c0-4b2e-9a46-937483bda3c3" priority="normal">
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="post" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C783bc706-7027-4d63-bdc7-39f885bc3652" priority="normal">
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C0b66c144-c6eb-4f0b-9148-e9e7220f97fc" priority="normal">
        <target>
            <property>
                <type name="RoadType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C01d34ad8-6db2-4d58-8bfa-5ef45239e015" priority="low">
        <target>
            <class>
                <type name="RoadWidthType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

/*
 * Was ist die beste Vorgehensweise hier?
 * a) RoadWidth-Objekt für jeden RoadLink/Objekt mit bekannter Breite
 * b) RoadWidth-Objekt geteilt für Objekte mit gleicher Breite (wie ID bestimmen?)
 *
 * aktuell a) umgesetzt
 */

collect.roadWidth.consume { values -&gt;
	def _id = 'RoadWidth_' + values[0]
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		width( values[1] ) {
			uom( values[2] )
		}
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu RoadLink
		networkRef {
			NetworkReference {
				element {
					href( '#' + values[0] )
				}
			}
		}
	}
}

</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RoadWidth`-Objekt für jedes Netzwerk-Element mit bekannter Breite.

Die Information welche Netzwerk-Elemente welche Eigenschaften bezüglich der Breite aufweisen wurde zuvor beim Erstellen der entsprechenden Features in einem Index abgelegt.

Die gesammelten Daten werden verwendet um die Informationen zu Breite, Maßeinheit und GML id des entsprechenden Features zu rekonstruieren. Mit letzterem wird eine Referenz (`NetworkReference`) zu dem Feature erstellt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C01d34ad8-6db2-4d58-8bfa-5ef45239e015" priority="normal">
        <target>
            <property>
                <type name="RoadWidthType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C809327ca-b90f-4c31-8cb4-b9988c5e0aa9" priority="normal">
        <target>
            <property>
                <type name="RoadWidthType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="measuredRoadPart" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/RoadPartValue/pavedSurface" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C01d34ad8-6db2-4d58-8bfa-5ef45239e015" priority="normal">
        <target>
            <property>
                <type name="RoadWidthType" ns="http://inspire.ec.europa.eu/schemas/tn-ro/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C6955e1ef-56ba-4ac9-9507-4203fc556956" priority="low">
        <target>
            <class>
                <type name="TrafficFlowDirectionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect&#13;
withTransformationContext {&#13;
	collect = _.context.collector(it)&#13;
}&#13;
&#13;
// Erstelle ein TrafficFlowDirection-Objekt für jeden vorkommenden Wert&#13;
collect.trafficFlowDirection.consume { key, values -&gt;&#13;
	def _id = 'TrafficFlowDirection' + key&#13;
	def _ns = _project.vars.INSPIRE_NAMESPACE&#13;
	&#13;
	_target {&#13;
		direction {&#13;
			href( 'http://inspire.ec.europa.eu/codelist/LinkDirectionValue/' + key)&#13;
		}&#13;
		id( _id )&#13;
		inspireId {&#13;
			Identifier {&#13;
				namespace( _ns )&#13;
				localId( _id )&#13;
			}&#13;
		}&#13;
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {&#13;
			codeSpace( 'http://inspire.ec.europa.eu/ids' )&#13;
		}&#13;
		&#13;
		// Referenz zu gesammelten RoadLinks/RoadAreas mit dieser Eigenschaft&#13;
		values.each { linkId -&gt;&#13;
			networkRef {&#13;
				NetworkReference {&#13;
					element {&#13;
						href( "#$linkId" )&#13;
					}&#13;
				}&#13;
			}&#13;
		}&#13;
	}&#13;
}
</core:text>
        </complexParameter>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C6955e1ef-56ba-4ac9-9507-4203fc556956" priority="normal">
        <target>
            <property>
                <type name="TrafficFlowDirectionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C6955e1ef-56ba-4ac9-9507-4203fc556956" priority="normal">
        <target>
            <property>
                <type name="TrafficFlowDirectionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C376c9fef-ac45-4e2c-9941-651740ba7400" priority="lowest">
        <target>
            <class>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collector

withTransformationContext {
	collector = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

_target {
	// Referenzen im TransportNetwork-Objekt nur erzeugen, wenn LIMIT_NETWORK_REFERENCES nicht verwendet wird
	if (!_refLimit) {
		// Verknüpfung zu gesammelten Netzwerk-Elementen
		collector.network.each { id -&gt;
			elements {
				href( "#$id" )
			}
		}
	}
}

</core:text>
        </complexParameter>
        <documentation>Erstellt das *TransportNetwork* für diese Netzwerk.

Zuvor wurde beim Erstellen jedes Netzwerk-Elements dessen GML id in einem Index abgelegt. Diese Information wird hier nun genutzt um auf alle Elemente des Netzwerks zu verweisen.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C60a849e5-b891-4866-8022-0cd07e0f01f4" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="language" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <parameter value="deu" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C8bd6e468-105d-4337-a3e7-f7355ed60664" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="nameStatus" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/NameStatusValue/official" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C56e9b1b9-1ade-49d5-9f53-37423fe9d061" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="nativeness" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/codelist/NativenessValue/endonym" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cf2ce1338-3fce-4a09-807d-09c3e76262d0" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="pronunciation" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="Cd1613f96-fd11-4e0b-b093-d38ce17cb580" priority="normal">
        <target name="result">
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="sourceOfName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def modellArt = _project.vars.ADV_MODELLART
if (modellArt) {
	_target(modellArt)
}
else {
	_target {
		nilReason( 'unknown' )
	}
}
</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Bestimmung aus Projekt-Variable (`ADV_MODELLART`) falls vorhanden, andernfalls wird *nilReason* auf `unknown` gesetzt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cd4048617-c86f-4863-99b5-3e9f0635a8f5" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="spelling" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="SpellingOfName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="script" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <parameter value="Latn" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C76fb8de5-dd5d-47c3-824e-3c37906a2c89" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="spelling" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="SpellingOfName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
                <child name="text" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
        <parameter value="{{project:NETWORK_NAME}}" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="C79bec27b-cdca-459d-9ecc-540aeca29d4b" priority="normal">
        <target name="result">
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">_project.vars.NETWORK_ID</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Weist die vorgegebene lokale ID für das Netzwerk zu.

Die Vorgabe kann über eine Projekt-Variable überschrieben werden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy" id="Cad28e1b9-331b-4b75-838f-94b202fdba1f" priority="normal">
        <target name="result">
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Zusammenfügen von INSPIRE namespace und localId

// namespace
def namespace = _project.vars.INSPIRE_NAMESPACE
// localId (vorgegebene localId für das Netzwerk)
def id = _project.vars.NETWORK_ID

if (namespace) {
  if (!namespace.endsWith('/')) {
    namespace = namespace + '/'
  }
  
  // namespace und id als Ergebnis
  namespace + id
}
else {
  // nur id als Ergebnis
  id
}
</core:text>
        </complexParameter>
        <parameter value="false" name="variablesAsInstances"/>
        <documentation>Erzeugt einen GML identifier basierend auf der INSPIRE ID. Dazu wird der vorgegebene INSPIRE Namespace und die vorgegebene lokale ID für das Netzwerk hinzugezogen.

Beide Vorgaben können über eine Projekt-Variable überschrieben werden.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cc9255943-592d-4e33-b874-03846d8c9a3c" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
                <child name="codeSpace"/>
            </property>
        </target>
        <parameter value="http://inspire.ec.europa.eu/ids" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Caddb8db5-f486-4664-a6b8-edd9eb936efe" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
        <parameter value="{{project:NETWORK_ID}}" name="value"/>
        <documentation>Weist die vorgegebene lokale ID für das Netzwerk zu.

Die Vorgabe kann über eine Projekt-Variable überschrieben werden.</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C935f563e-2939-4fcc-aecc-8029498b746b" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C72fea6b2-4d97-4299-9f1b-39cf00ffe3d3" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="typeOfTransport" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </property>
        </target>
        <parameter value="road" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C00cccf8c-b815-4fa9-b89c-6f37d12ae435" priority="lowest">
        <target>
            <class>
                <type name="VerticalPositionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _refLimit = _project.vars.LIMIT_NETWORK_REFERENCES

// Erstelle ein VerticalPosition-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.verticalPosition.consume { key, values -&gt;
	def _id = 'VerticalPosition_' + _project.vars.THEME_DISTINGUISHER + '_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	def valueGroups = _refLimit ? values.collate(_refLimit as int) : [values]
	def i = 1		
	valueGroups.each { valueGroup -&gt;
		def _id2 = _id 
		if (valueGroups.size &gt; 1) {
			// Gruppennummer anhängen, falls es mehr als eine Gruppe gibt
			_id2 += '_' + i++
		}
		_target {
			verticalPosition( key )
			id( _id2 )
			inspireId {
				Identifier {
					namespace( _ns )
					localId( _id2 )
				}
			}
			identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id2 : _id2 ) {
				codeSpace( 'http://inspire.ec.europa.eu/ids' )
			}
			
			// Referenz zu gesammelten Netzwerk-Elementen mit dieser Eigenschaft
			valueGroup.each { linkId -&gt;
				networkRef {
					NetworkReference {
						element {
							href( "#$linkId" )
						}
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C6563043b-57b7-4264-b3ff-6264b547216f_C00cccf8c-b815-4fa9-b89c-6f37d12ae435" priority="normal">
        <target>
            <property>
                <type name="VerticalPositionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>`TransportProperty`-Objekte sind im Rahmen der Transformation neu gebildete Objekte und übernehmen daher keine Information für `beginLifespanVersion` aus den Quell-Daten.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C9fbdcf9a-e35a-4f33-b915-77155350de27_C00cccf8c-b815-4fa9-b89c-6f37d12ae435" priority="normal">
        <target>
            <property>
                <type name="VerticalPositionType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
        <documentation>Diese Information ist im 3A-Modell nicht vorhanden.</documentation>
    </cell>
    <modifier cell="C010d8324-6422-49f2-883a-7ee5d875177b_C2581bae5-bd09-416c-948e-bcb8b5835ca3">
        <disable-for parent="C2581bae5-bd09-416c-948e-bcb8b5835ca3"/>
    </modifier>
    <modifier cell="C010d8324-6422-49f2-883a-7ee5d875177b_C2827fa08-a3dd-4539-83de-413c6b922f47">
        <disable-for parent="C2827fa08-a3dd-4539-83de-413c6b922f47"/>
    </modifier>
    <modifier cell="C03716a0b-a2f7-4f4b-8d93-13d186c7af73_Cb090758a-65b1-49f7-a92e-42ef7d8afb04">
        <disable-for parent="Cb090758a-65b1-49f7-a92e-42ef7d8afb04"/>
    </modifier>
    <modifier cell="C6563043b-57b7-4264-b3ff-6264b547216f_C7167685d-1927-4e65-82f3-b01258f955b4">
        <disable-for parent="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd"/>
        <disable-for parent="C7167685d-1927-4e65-82f3-b01258f955b4"/>
    </modifier>
    <modifier cell="C6563043b-57b7-4264-b3ff-6264b547216f_Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd">
        <disable-for parent="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd"/>
        <disable-for parent="C7167685d-1927-4e65-82f3-b01258f955b4"/>
    </modifier>
    <modifier cell="C87845354-a68e-4c9b-98a0-8d05883d4e0d">
        <disable-for parent="C2581bae5-bd09-416c-948e-bcb8b5835ca3"/>
        <disable-for parent="C2827fa08-a3dd-4539-83de-413c6b922f47"/>
    </modifier>
    <modifier cell="C926d15b8-a481-4947-a796-ae74e3d6e3d7">
        <disable-for parent="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd"/>
        <disable-for parent="C7167685d-1927-4e65-82f3-b01258f955b4"/>
    </modifier>
    <modifier cell="C9fbdcf9a-e35a-4f33-b915-77155350de27_C7167685d-1927-4e65-82f3-b01258f955b4">
        <disable-for parent="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd"/>
        <disable-for parent="C7167685d-1927-4e65-82f3-b01258f955b4"/>
    </modifier>
    <modifier cell="C9fbdcf9a-e35a-4f33-b915-77155350de27_Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd">
        <disable-for parent="Ca30ad72d-b136-4147-b4a6-21e3a41ac5fd"/>
        <disable-for parent="C7167685d-1927-4e65-82f3-b01258f955b4"/>
    </modifier>
    <modifier cell="Ca75e7935-ff63-4356-909a-b59d866bc062">
        <disable-for parent="C3296f18d-e980-40cf-a9f3-9e5187ecf16a"/>
        <disable-for parent="Cc8dfcac2-f330-4946-b4d6-8e1a87136c04"/>
    </modifier>
    <modifier cell="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_C2581bae5-bd09-416c-948e-bcb8b5835ca3">
        <disable-for parent="C2581bae5-bd09-416c-948e-bcb8b5835ca3"/>
    </modifier>
    <modifier cell="Ce5efa00a-e0b4-4541-bb3d-332da94c1c7e_C2827fa08-a3dd-4539-83de-413c6b922f47">
        <disable-for parent="C2827fa08-a3dd-4539-83de-413c6b922f47"/>
    </modifier>
</alignment>
